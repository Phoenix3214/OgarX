(function(){function b(d,e,g){function a(j,i){if(!e[j]){if(!d[j]){var f="function"==typeof require&&require;if(!i&&f)return f(j,!0);if(h)return h(j,!0);var c=new Error("Cannot find module '"+j+"'");throw c.code="MODULE_NOT_FOUND",c}var k=e[j]={exports:{}};d[j][0].call(k.exports,function(b){var c=d[j][1][b];return a(c||b)},k,k.exports,b,d,e,g)}return e[j].exports}for(var h="function"==typeof require&&require,c=0;c<g.length;c++)a(g[c]);return a}return b})()({1:[function(a,b){const c=a("./mouse"),d=a("./state"),e=a("./viewport");b.exports=class{constructor(){this.worker=new Worker("js/renderer.min.js"),this.canvas=document.getElementById("canvas"),this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.showing=!0,this.mouse=new c,this.state=new d,this.viewport=new e;const a=canvas.transferControlToOffscreen(),b={offscreen:a,mouse:this.mouse.sharedBuffer,state:this.state.sharedBuffer,viewport:this.viewport.sharedBuffer};this.worker.postMessage(b,[a]),this.worker.onmessage=a=>{"ready"===a.data&&(this.ready=!0)},this.registerEvents(),this.resize(),this.initUIComponents()}show(){this.showing=!0,this.hudElem.style.opacity=1,setTimeout(()=>this.hudElem.style.zIndex=1,250)}hide(){this.showing=!1,this.hudElem.style.opacity=0,setTimeout(()=>this.hudElem.style.zIndex=0,250)}toggle(){this.showing?this.hide():this.show()}resize(){console.log("RESIZING"),this.viewport.width=window.devicePixelRatio*window.innerWidth,this.viewport.height=window.devicePixelRatio*window.innerHeight,this.canvas.style.width=window.innerWidth,this.canvas.style.height=window.innerHeight}registerEvents(){window.onresize=()=>this.resize.bind(this),this.pressing=new Set;const a=this.state;window.addEventListener("keydown",b=>{"Tab"==b.key&&b.preventDefault(),"Escape"==b.key&&this.toggle();this.pressing.has(b.key)||("w"==b.key&&(a.macro=1)," "==b.key&&(a.splits=1),"g"==b.key&&(a.splits=2),"z"==b.key&&(a.splits=3),"q"==b.key&&(a.splits=4),"n"==b.key&&(a.respawn=1),this.pressing.add(b.key))}),window.addEventListener("keyup",b=>{"w"==b.key&&(a.macro=0),this.pressing.delete(b.key)}),window.addEventListener("blur",()=>a.focused=0),window.addEventListener("focus",()=>a.focused=1),a.focused=1,canvas.addEventListener("mousemove",a=>(this.mouse.x=a.clientX,this.mouse.y=a.clientY)),canvas.addEventListener("wheel",a=>this.mouse.updateScroll(a.deltaY),{passive:!0})}initUIComponents(){this.hudElem=document.getElementById("hud"),this.skinElem=document.getElementById("skin"),this.skinInput=document.getElementById("skin-input"),this.serverInput=document.getElementById("server-input"),this.nameInput=document.getElementById("name-input"),this.skinInput.addEventListener("blur",()=>{const a=new Image;a.onload=()=>{this.skinInput.classList.remove("danger"),this.skinElem.src=this.skin},a.onerror=()=>this.skinInput.classList.add("danger"),a.src=this.skin}),this.connectButton=document.getElementById("connect"),this.connectButton.addEventListener("click",()=>{this.spawn(),this.hide(),this.connectButton.blur()})}get skin(){return this.skinInput.value}get name(){return this.nameInput.value}get server(){return this.serverInput.value}spawn(){"local"==this.server?this.connectToLocal():this.connectToURL(this.server),this.worker.postMessage({spawn:!0,name:this.name,skin:this.skin})}connectToLocal(){const a=new SharedWorker("js/sw.min.js","ogar-x-server");this.worker.postMessage({connect:a.port},[a.port])}connectToURL(a){this.worker.postMessage({connect:a})}}},{"./mouse":3,"./state":4,"./viewport":5}],2:[function(a){const b=a("./hud");window.onload=()=>window.app=new b},{"./hud":1}],3:[function(a,b){b.exports=class{constructor(){this.setBuffer()}setBuffer(a=new SharedArrayBuffer(12)){this.sharedBuffer=a,this.buffer=new Int32Array(this.sharedBuffer)}get x(){return Atomics.load(this.buffer,0)}set x(a){Atomics.store(this.buffer,0,a)}get y(){return Atomics.load(this.buffer,1)}set y(a){Atomics.store(this.buffer,1,a)}get scroll(){return Atomics.load(this.buffer,2)}set scroll(a){Atomics.store(this.buffer,2,a)}updateScroll(a){Atomics.add(this.buffer,2,a)}resetScroll(){return Atomics.exchange(this.buffer,2,0)}}},{}],4:[function(a,b){b.exports=class{constructor(){this.setBuffer()}setBuffer(a=new SharedArrayBuffer(6)){this.sharedBuffer=a,this.buffer=new Uint8Array(this.sharedBuffer)}get spectate(){return Atomics.load(this.buffer,0)}set spectate(a){Atomics.store(this.buffer,0,a)}get splits(){return Atomics.load(this.buffer,1)}set splits(a){Atomics.add(this.buffer,1,a)}get ejects(){return Atomics.load(this.buffer,2)}set ejects(a){Atomics.add(this.buffer,2,a)}get macro(){return Atomics.load(this.buffer,3)}set macro(a){Atomics.store(this.buffer,3,a)}get respawn(){return Atomics.load(this.buffer,4)}set respawn(a){Atomics.store(this.buffer,4,a)}get focused(){return Atomics.load(this.buffer,5)}set focused(a){Atomics.store(this.buffer,5,a)}exchange(){return{spectate:Atomics.exchange(this.buffer,0,0),splits:Atomics.exchange(this.buffer,1,0),ejects:Atomics.exchange(this.buffer,2,0),macro:this.macro,respawn:Atomics.exchange(this.buffer,4,0)}}}},{}],5:[function(a,b){b.exports=class{constructor(){this.setBuffer()}setBuffer(a=new SharedArrayBuffer(8)){this.sharedBuffer=a,this.buffer=new Int32Array(this.sharedBuffer)}get width(){return Atomics.load(this.buffer,0)}set width(a){Atomics.store(this.buffer,0,a)}get height(){return Atomics.load(this.buffer,1)}set height(a){Atomics.store(this.buffer,1,a)}}},{}]},{},[2]);
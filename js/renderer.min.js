(function(){function s(d,e,r){function t(o,i){if(!e[o]){if(!d[o]){var l="function"==typeof require&&require;if(!i&&l)return l(o,!0);if(n)return n(o,!0);var _=new Error("Cannot find module '"+o+"'");throw _.code="MODULE_NOT_FOUND",_}var a=e[o]={exports:{}};d[o][0].call(a.exports,function(e){var a=d[o][1][e];return t(a||e)},a,a.exports,s,d,e,r)}return e[o].exports}for(var n="function"==typeof require&&require,a=0;a<r.length;a++)t(r[a]);return t}return s})()({1:[function(e,t){'use strict';function a(e){console&&console.warn&&console.warn(e)}function r(){r.init.call(this)}function s(e){if("function"!=typeof e)throw new TypeError("The \"listener\" argument must be of type Function. Received type "+typeof e)}function n(e){return void 0===e._maxListeners?r.defaultMaxListeners:e._maxListeners}function i(e,t,r,i){var o,d,l;if(s(r),d=e._events,void 0===d?(d=e._events=Object.create(null),e._eventsCount=0):(void 0!==d.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),d=e._events),l=d[t]),void 0===l)l=d[t]=r,++e._eventsCount;else if("function"==typeof l?l=d[t]=i?[r,l]:[l,r]:i?l.unshift(r):l.push(r),o=n(e),0<o&&l.length>o&&!l.warned){l.warned=!0;var _=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+(t+" listeners added. Use emitter.setMaxListeners() to increase limit"));_.name="MaxListenersExceededWarning",_.emitter=e,_.type=t,_.count=l.length,a(_)}return e}function o(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,a){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:a},s=o.bind(r);return s.listener=a,r.wrapFn=s,s}function l(e,t,a){var r=e._events;if(r===void 0)return[];var s=r[t];return void 0===s?[]:"function"==typeof s?a?[s.listener||s]:[s]:a?c(s):f(s,s.length)}function _(e){var t=this._events;if(t!==void 0){var a=t[e];if("function"==typeof a)return 1;if(void 0!==a)return a.length}return 0}function f(e,t){for(var a=Array(t),r=0;r<t;++r)a[r]=e[r];return a}function p(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function c(e){for(var t=Array(e.length),a=0;a<t.length;++a)t[a]=e[a].listener||e[a];return t}var h,u="object"==typeof Reflect?Reflect:null,g=u&&"function"==typeof u.apply?u.apply:function(e,t,a){return Function.prototype.apply.call(e,t,a)};h=u&&"function"==typeof u.ownKeys?u.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var m=Number.isNaN||function(e){return e!==e};t.exports=r,t.exports.once=function(e,t){return new Promise(function(a,r){function s(){n!==void 0&&e.removeListener("error",n),a([].slice.call(arguments))}var n;"error"!==t&&(n=function(a){e.removeListener(t,s),r(a)},e.once("error",n)),e.once(t,s)})},r.EventEmitter=r,r.prototype._events=void 0,r.prototype._eventsCount=0,r.prototype._maxListeners=void 0;var b=10;Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function(){return b},set:function(e){if("number"!=typeof e||0>e||m(e))throw new RangeError("The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received "+e+".");b=e}}),r.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},r.prototype.setMaxListeners=function(e){if("number"!=typeof e||0>e||m(e))throw new RangeError("The value of \"n\" is out of range. It must be a non-negative number. Received "+e+".");return this._maxListeners=e,this},r.prototype.getMaxListeners=function(){return n(this)},r.prototype.emit=function(e){for(var t=[],a=1;a<arguments.length;a++)t.push(arguments[a]);var r="error"===e,s=this._events;if(s!==void 0)r=r&&s.error===void 0;else if(!r)return!1;if(r){var n;if(0<t.length&&(n=t[0]),n instanceof Error)throw n;var o=new Error("Unhandled error."+(n?" ("+n.message+")":""));throw o.context=n,o}var d=s[e];if(d===void 0)return!1;if("function"==typeof d)g(d,this,t);else for(var l=d.length,_=f(d,l),a=0;a<l;++a)g(_[a],this,t);return!0},r.prototype.addListener=function(e,t){return i(this,e,t,!1)},r.prototype.on=r.prototype.addListener,r.prototype.prependListener=function(e,t){return i(this,e,t,!0)},r.prototype.once=function(e,t){return s(t),this.on(e,d(this,e,t)),this},r.prototype.prependOnceListener=function(e,t){return s(t),this.prependListener(e,d(this,e,t)),this},r.prototype.removeListener=function(e,t){var a,r,n,o,d;if(s(t),r=this._events,void 0===r)return this;if(a=r[e],void 0===a)return this;if(a===t||a.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,a.listener||t));else if("function"!=typeof a){for(n=-1,o=a.length-1;0<=o;o--)if(a[o]===t||a[o].listener===t){d=a[o].listener,n=o;break}if(0>n)return this;0===n?a.shift():p(a,n),1===a.length&&(r[e]=a[0]),void 0!==r.removeListener&&this.emit("removeListener",e,d||t)}return this},r.prototype.off=r.prototype.removeListener,r.prototype.removeAllListeners=function(e){var t,a,r;if(a=this._events,void 0===a)return this;if(void 0===a.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==a[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete a[e]),this;if(0===arguments.length){var s,n=Object.keys(a);for(r=0;r<n.length;++r)s=n[r],"removeListener"!==s&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=a[e],"function"==typeof t)this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;0<=r;r--)this.removeListener(e,t[r]);return this},r.prototype.listeners=function(e){return l(this,e,!0)},r.prototype.rawListeners=function(e){return l(this,e,!1)},r.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):_.call(e,t)},r.prototype.listenerCount=_,r.prototype.eventNames=function(){return 0<this._eventsCount?h(this._events):[]}},{}],2:[function(e,t){'use strict';const{Deflate:a,deflate:r,deflateRaw:s,gzip:n}=e("./lib/deflate"),{Inflate:i,inflate:o,inflateRaw:d,ungzip:l}=e("./lib/inflate"),_=e("./lib/zlib/constants");t.exports.Deflate=a,t.exports.deflate=r,t.exports.deflateRaw=s,t.exports.gzip=n,t.exports.Inflate=i,t.exports.inflate=o,t.exports.inflateRaw=d,t.exports.ungzip=l,t.exports.constants=_},{"./lib/deflate":3,"./lib/inflate":4,"./lib/zlib/constants":8}],3:[function(e,t){'use strict';function a(e){this.options=n.assign({level:g,method:b,chunkSize:16384,windowBits:15,memLevel:8,strategy:m},e||{});let t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&16>t.windowBits&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;let a=s.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(a!==h)throw new Error(o[a]);if(t.header&&s.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?i.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,a=s.deflateSetDictionary(this.strm,e),a!==h)throw new Error(o[a]);this._dict_set=!0}}function r(e,t){const r=new a(t);if(r.push(e,!0),r.err)throw r.msg||o[r.err];return r.result}const s=e("./zlib/deflate"),n=e("./utils/common"),i=e("./utils/strings"),o=e("./zlib/messages"),d=e("./zlib/zstream"),l=Object.prototype.toString,{Z_NO_FLUSH:_,Z_SYNC_FLUSH:f,Z_FULL_FLUSH:p,Z_FINISH:c,Z_OK:h,Z_STREAM_END:u,Z_DEFAULT_COMPRESSION:g,Z_DEFAULT_STRATEGY:m,Z_DEFLATED:b}=e("./zlib/constants");a.prototype.push=function(e,t){const a=this.strm,r=this.options.chunkSize;let n,o;if(this.ended)return!1;for(o=t===~~t?t:!0===t?c:_,a.input="string"==typeof e?i.string2buf(e):"[object ArrayBuffer]"===l.call(e)?new Uint8Array(e):e,a.next_in=0,a.avail_in=a.input.length;;){if(0===a.avail_out&&(a.output=new Uint8Array(r),a.next_out=0,a.avail_out=r),(o===f||o===p)&&6>=a.avail_out){this.onData(a.output.subarray(0,a.next_out)),a.avail_out=0;continue}if(n=s.deflate(a,o),n===u)return 0<a.next_out&&this.onData(a.output.subarray(0,a.next_out)),n=s.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===h;if(0===a.avail_out){this.onData(a.output);continue}if(0<o&&0<a.next_out){this.onData(a.output.subarray(0,a.next_out)),a.avail_out=0;continue}if(0===a.avail_in)break}return!0},a.prototype.onData=function(e){this.chunks.push(e)},a.prototype.onEnd=function(e){e===h&&(this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.exports.Deflate=a,t.exports.deflate=r,t.exports.deflateRaw=function(e,t){return t=t||{},t.raw=!0,r(e,t)},t.exports.gzip=function(e,t){return t=t||{},t.gzip=!0,r(e,t)},t.exports.constants=e("./zlib/constants")},{"./utils/common":5,"./utils/strings":6,"./zlib/constants":8,"./zlib/deflate":10,"./zlib/messages":15,"./zlib/zstream":17}],4:[function(e,t){'use strict';function a(e){this.options=n.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&0<=t.windowBits&&16>t.windowBits&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),0<=t.windowBits&&16>t.windowBits&&!(e&&e.windowBits)&&(t.windowBits+=32),15<t.windowBits&&48>t.windowBits&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;let a=s.inflateInit2(this.strm,t.windowBits);if(a!==c)throw new Error(o[a]);if(this.header=new l,s.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=i.string2buf(t.dictionary):"[object ArrayBuffer]"===_.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(a=s.inflateSetDictionary(this.strm,t.dictionary),a!==c)))throw new Error(o[a])}function r(e,t){const r=new a(t);if(r.push(e),r.err)throw r.msg||o[r.err];return r.result}const s=e("./zlib/inflate"),n=e("./utils/common"),i=e("./utils/strings"),o=e("./zlib/messages"),d=e("./zlib/zstream"),l=e("./zlib/gzheader"),_=Object.prototype.toString,{Z_NO_FLUSH:f,Z_FINISH:p,Z_OK:c,Z_STREAM_END:h,Z_NEED_DICT:u,Z_STREAM_ERROR:g,Z_DATA_ERROR:m,Z_MEM_ERROR:b}=e("./zlib/constants");a.prototype.push=function(e,t){const a=this.strm,r=this.options.chunkSize,n=this.options.dictionary;let o,d,l;if(this.ended)return!1;for(d=t===~~t?t:!0===t?p:f,a.input="[object ArrayBuffer]"===_.call(e)?new Uint8Array(e):e,a.next_in=0,a.avail_in=a.input.length;;){for(0===a.avail_out&&(a.output=new Uint8Array(r),a.next_out=0,a.avail_out=r),o=s.inflate(a,d),o===u&&n&&(o=s.inflateSetDictionary(a,n),o===c?o=s.inflate(a,d):o===m&&(o=u));0<a.avail_in&&o===h&&0<a.state.wrap&&0!==e[a.next_in];)s.inflateReset(a),o=s.inflate(a,d);switch(o){case g:case m:case u:case b:return this.onEnd(o),this.ended=!0,!1;}if(l=a.avail_out,a.next_out&&(0===a.avail_out||o===h))if("string"===this.options.to){let e=i.utf8border(a.output,a.next_out),t=a.next_out-e,s=i.buf2string(a.output,e);a.next_out=t,a.avail_out=r-t,t&&a.output.set(a.output.subarray(e,e+t),0),this.onData(s)}else this.onData(a.output.length===a.next_out?a.output:a.output.subarray(0,a.next_out));if(o!==c||0!==l){if(o===h)return o=s.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===a.avail_in)break}}return!0},a.prototype.onData=function(e){this.chunks.push(e)},a.prototype.onEnd=function(e){e===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.exports.Inflate=a,t.exports.inflate=r,t.exports.inflateRaw=function(e,t){return t=t||{},t.raw=!0,r(e,t)},t.exports.ungzip=r,t.exports.constants=e("./zlib/constants")},{"./utils/common":5,"./utils/strings":6,"./zlib/constants":8,"./zlib/gzheader":11,"./zlib/inflate":13,"./zlib/messages":15,"./zlib/zstream":17}],5:[function(e,t){'use strict';const a=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);t.exports.assign=function(e){for(const t=Array.prototype.slice.call(arguments,1);t.length;){const r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(const t in r)a(r,t)&&(e[t]=r[t])}}return e},t.exports.flattenChunks=e=>{let t=0;for(let a=0,r=e.length;a<r;a++)t+=e[a].length;const a=new Uint8Array(t);for(let t,r=0,s=0,n=e.length;r<n;r++)t=e[r],a.set(t,s),s+=t.length;return a}},{}],6:[function(e,t){'use strict';var a=String.fromCharCode;let r=!0;try{a.apply(null,new Uint8Array(1))}catch(e){r=!1}const s=new Uint8Array(256);for(let a=0;256>a;a++)s[a]=252<=a?6:248<=a?5:240<=a?4:224<=a?3:192<=a?2:1;s[254]=s[254]=1,t.exports.string2buf=e=>{let t,a,r,s,n,o=e.length,d=0;for(s=0;s<o;s++)a=e.charCodeAt(s),55296==(64512&a)&&s+1<o&&(r=e.charCodeAt(s+1),56320==(64512&r)&&(a=65536+(a-55296<<10)+(r-56320),s++)),d+=128>a?1:2048>a?2:65536>a?3:4;for(t=new Uint8Array(d),n=0,s=0;n<d;s++)a=e.charCodeAt(s),55296==(64512&a)&&s+1<o&&(r=e.charCodeAt(s+1),56320==(64512&r)&&(a=65536+(a-55296<<10)+(r-56320),s++)),128>a?t[n++]=a:2048>a?(t[n++]=192|a>>>6,t[n++]=128|63&a):65536>a?(t[n++]=224|a>>>12,t[n++]=128|63&a>>>6,t[n++]=128|63&a):(t[n++]=240|a>>>18,t[n++]=128|63&a>>>12,t[n++]=128|63&a>>>6,t[n++]=128|63&a);return t};const n=(e,t)=>{if(65534>t&&e.subarray&&r)return a.apply(null,e.length===t?e:e.subarray(0,t));let s="";for(let r=0;r<t;r++)s+=a(e[r]);return s};t.exports.buf2string=(e,t)=>{let a,r;const o=t||e.length,d=Array(2*o);for(r=0,a=0;a<o;){let t=e[a++];if(128>t){d[r++]=t;continue}let n=s[t];if(4<n){d[r++]=65533,a+=n-1;continue}for(t&=2===n?31:3===n?15:7;1<n&&a<o;)t=t<<6|63&e[a++],n--;if(1<n){d[r++]=65533;continue}65536>t?d[r++]=t:(t-=65536,d[r++]=55296|1023&t>>10,d[r++]=56320|1023&t)}return n(d,r)},t.exports.utf8border=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let a=t-1;for(;0<=a&&128==(192&e[a]);)a--;return 0>a?t:0==a?t:a+s[e[a]]>t?a:t}},{}],7:[function(e,t){'use strict';t.exports=(e,t,a,r)=>{let s=0|65535&e,i=0|65535&e>>>16,o=0;for(;0!==a;){o=2e3<a?2e3:a,a-=o;do s=0|s+t[r++],i=0|i+s;while(--o);s%=65521,i%=65521}return 0|(s|i<<16)}},{}],8:[function(e,t){'use strict';t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],9:[function(e,t){'use strict';const a=new Uint32Array((()=>{let e,t=[];for(var a=0;256>a;a++){e=a;for(var r=0;8>r;r++)e=1&e?3988292384^e>>>1:e>>>1;t[a]=e}return t})());t.exports=(e,t,r,s)=>{e^=-1;for(let n=s;n<s+r;n++)e=e>>>8^a[255&(e^t[n])];return-1^e}},{}],10:[function(e,t){'use strict';function a(e,t,a,r,s){this.good_length=e,this.max_lazy=t,this.nice_length=a,this.max_chain=r,this.func=s}function r(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=I,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),V(this.dyn_ltree),V(this.dyn_dtree),V(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),V(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),V(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const{_tr_init:n,_tr_stored_block:i,_tr_flush_block:o,_tr_tally:d,_tr_align:l}=e("./trees"),_=e("./adler32"),f=e("./crc32"),p=e("./messages"),{Z_NO_FLUSH:c,Z_PARTIAL_FLUSH:h,Z_FULL_FLUSH:u,Z_FINISH:g,Z_BLOCK:m,Z_OK:b,Z_STREAM_END:w,Z_STREAM_ERROR:x,Z_DATA_ERROR:E,Z_BUF_ERROR:v,Z_DEFAULT_COMPRESSION:y,Z_FILTERED:R,Z_HUFFMAN_ONLY:T,Z_RLE:A,Z_FIXED:k,Z_DEFAULT_STRATEGY:S,Z_UNKNOWN:U,Z_DEFLATED:I}=e("./constants"),D=3,L=258,z=L+D+1,F=42,C=69,P=73,B=91,N=103,O=113,M=666,Z=1,H=2,X=3,G=4,Y=(e,t)=>(e.msg=p[t],t),j=e=>(e<<1)-(4<e?9:0),V=e=>{for(let t=e.length;0<=--t;)e[t]=0};let W=(e,t,a)=>(t<<e.hash_shift^a)&e.hash_mask;const K=e=>{const t=e.state;let a=t.pending;a>e.avail_out&&(a=e.avail_out);0===a||(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+a),e.next_out),e.next_out+=a,t.pending_out+=a,e.total_out+=a,e.avail_out-=a,t.pending-=a,0===t.pending&&(t.pending_out=0))},q=(e,t)=>{o(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,K(e.strm)},Q=(e,t)=>{e.pending_buf[e.pending++]=t},J=(e,t)=>{e.pending_buf[e.pending++]=255&t>>>8,e.pending_buf[e.pending++]=255&t},$=(e,t,a,r)=>{let s=e.avail_in;return(s>r&&(s=r),0===s)?0:(e.avail_in-=s,t.set(e.input.subarray(e.next_in,e.next_in+s),a),1===e.state.wrap?e.adler=_(e.adler,t,s,a):2===e.state.wrap&&(e.adler=f(e.adler,t,s,a)),e.next_in+=s,e.total_in+=s,s)},ee=(e,t)=>{let a,r,s=e.max_chain_length,n=e.strstart,i=e.prev_length,o=e.nice_match;const d=e.strstart>e.w_size-z?e.strstart-(e.w_size-z):0,l=e.window,_=e.w_mask,f=e.prev,p=e.strstart+L;let c=l[n+i-1],h=l[n+i];e.prev_length>=e.good_match&&(s>>=2),o>e.lookahead&&(o=e.lookahead);do{if(a=t,l[a+i]!==h||l[a+i-1]!==c||l[a]!==l[n]||l[++a]!==l[n+1])continue;n+=2,a++;do;while(l[++n]===l[++a]&&l[++n]===l[++a]&&l[++n]===l[++a]&&l[++n]===l[++a]&&l[++n]===l[++a]&&l[++n]===l[++a]&&l[++n]===l[++a]&&l[++n]===l[++a]&&n<p);if(r=L-(p-n),n=p-L,r>i){if(e.match_start=t,i=r,r>=o)break;c=l[n+i-1],h=l[n+i]}}while((t=f[t&_])>d&&0!=--s);return i<=e.lookahead?i:e.lookahead},te=e=>{const t=e.w_size;let a,r,s,i,o;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-z)){e.window.set(e.window.subarray(t,t+t),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,r=e.hash_size,a=r;do s=e.head[--a],e.head[a]=s>=t?s-t:0;while(--r);r=t,a=r;do s=e.prev[--a],e.prev[a]=s>=t?s-t:0;while(--r);i+=t}if(0===e.strm.avail_in)break;if(r=$(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=r,e.lookahead+e.insert>=D)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=W(e,e.ins_h,e.window[o+1]);e.insert&&(e.ins_h=W(e,e.ins_h,e.window[o+D-1]),e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<D)););}while(e.lookahead<z&&0!==e.strm.avail_in)},ae=(e,t)=>{let a,r;for(;;){if(e.lookahead<z){if(te(e),e.lookahead<z&&t===c)return Z;if(0===e.lookahead)break}if(a=0,e.lookahead>=D&&(e.ins_h=W(e,e.ins_h,e.window[e.strstart+D-1]),a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==a&&e.strstart-a<=e.w_size-z&&(e.match_length=ee(e,a)),!(e.match_length>=D))r=d(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;else if(r=d(e,e.strstart-e.match_start,e.match_length-D),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=D){e.match_length--;do e.strstart++,e.ins_h=W(e,e.ins_h,e.window[e.strstart+D-1]),a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=W(e,e.ins_h,e.window[e.strstart+1]);if(r&&(q(e,!1),0===e.strm.avail_out))return Z}return e.insert=e.strstart<D-1?e.strstart:D-1,t===g?(q(e,!0),0===e.strm.avail_out?X:G):e.last_lit&&(q(e,!1),0===e.strm.avail_out)?Z:H},re=(e,t)=>{let a,r,s;for(;;){if(e.lookahead<z){if(te(e),e.lookahead<z&&t===c)return Z;if(0===e.lookahead)break}if(a=0,e.lookahead>=D&&(e.ins_h=W(e,e.ins_h,e.window[e.strstart+D-1]),a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=D-1,0!==a&&e.prev_length<e.max_lazy_match&&e.strstart-a<=e.w_size-z&&(e.match_length=ee(e,a),5>=e.match_length&&(e.strategy===R||e.match_length===D&&4096<e.strstart-e.match_start)&&(e.match_length=D-1)),e.prev_length>=D&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-D,r=d(e,e.strstart-1-e.prev_match,e.prev_length-D),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=s&&(e.ins_h=W(e,e.ins_h,e.window[e.strstart+D-1]),a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(0!=--e.prev_length);if(e.match_available=0,e.match_length=D-1,e.strstart++,r&&(q(e,!1),0===e.strm.avail_out))return Z}else if(!e.match_available)e.match_available=1,e.strstart++,e.lookahead--;else if(r=d(e,0,e.window[e.strstart-1]),r&&q(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return Z}return e.match_available&&(r=d(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<D-1?e.strstart:D-1,t===g?(q(e,!0),0===e.strm.avail_out?X:G):e.last_lit&&(q(e,!1),0===e.strm.avail_out)?Z:H},se=(e,t)=>{let a,r,s,n;for(const i=e.window;;){if(e.lookahead<=L){if(te(e),e.lookahead<=L&&t===c)return Z;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=D&&0<e.strstart&&(s=e.strstart-1,r=i[s],r===i[++s]&&r===i[++s]&&r===i[++s])){n=e.strstart+L;do;while(r===i[++s]&&r===i[++s]&&r===i[++s]&&r===i[++s]&&r===i[++s]&&r===i[++s]&&r===i[++s]&&r===i[++s]&&s<n);e.match_length=L-(n-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=D?(a=d(e,1,e.match_length-D),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(a=d(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),a&&(q(e,!1),0===e.strm.avail_out))return Z}return e.insert=0,t===g?(q(e,!0),0===e.strm.avail_out?X:G):e.last_lit&&(q(e,!1),0===e.strm.avail_out)?Z:H},ne=(e,t)=>{for(let a;;){if(0===e.lookahead&&(te(e),0===e.lookahead)){if(t===c)return Z;break}if(e.match_length=0,a=d(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,a&&(q(e,!1),0===e.strm.avail_out))return Z}return e.insert=0,t===g?(q(e,!0),0===e.strm.avail_out?X:G):e.last_lit&&(q(e,!1),0===e.strm.avail_out)?Z:H},ie=[new a(0,0,0,0,(e,t)=>{let a=65535;for(a>e.pending_buf_size-5&&(a=e.pending_buf_size-5);;){if(1>=e.lookahead){if(te(e),0===e.lookahead&&t===c)return Z;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;const r=e.block_start+a;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,q(e,!1),0===e.strm.avail_out))return Z;if(e.strstart-e.block_start>=e.w_size-z&&(q(e,!1),0===e.strm.avail_out))return Z}return e.insert=0,t===g?(q(e,!0),0===e.strm.avail_out?X:G):e.strstart>e.block_start&&(q(e,!1),0===e.strm.avail_out)?Z:Z}),new a(4,4,8,4,ae),new a(4,5,16,8,ae),new a(4,6,32,32,ae),new a(4,4,16,16,re),new a(8,16,32,32,re),new a(8,16,128,128,re),new a(8,32,128,256,re),new a(32,128,258,1024,re),new a(32,258,258,4096,re)],oe=e=>{e.window_size=2*e.w_size,V(e.head),e.max_lazy_match=ie[e.level].max_lazy,e.good_match=ie[e.level].good_length,e.nice_match=ie[e.level].nice_length,e.max_chain_length=ie[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=D-1,e.match_available=0,e.ins_h=0},de=e=>{if(!e||!e.state)return Y(e,x);e.total_in=e.total_out=0,e.data_type=U;const t=e.state;return t.pending=0,t.pending_out=0,0>t.wrap&&(t.wrap=-t.wrap),t.status=t.wrap?F:O,e.adler=2===t.wrap?0:1,t.last_flush=c,n(t),b},le=e=>{const t=de(e);return t===b&&oe(e.state),t},_e=(e,t,a,n,i,o)=>{if(!e)return x;let d=1;if(t===y&&(t=6),0>n?(d=0,n=-n):15<n&&(d=2,n-=16),1>i||i>9||a!==I||8>n||15<n||0>t||9<t||0>o||o>k)return Y(e,x);8===n&&(n=9);const l=new r;return e.state=l,l.strm=e,l.wrap=d,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=i+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+D-1)/D),l.window=new Uint8Array(2*l.w_size),l.head=new Uint16Array(l.hash_size),l.prev=new Uint16Array(l.w_size),l.lit_bufsize=1<<i+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new Uint8Array(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=o,l.method=a,le(e)};t.exports.deflateInit=(e,t)=>_e(e,t,I,15,8,S),t.exports.deflateInit2=_e,t.exports.deflateReset=le,t.exports.deflateResetKeep=de,t.exports.deflateSetHeader=(e,t)=>e&&e.state?2===e.state.wrap?(e.state.gzhead=t,b):x:x,t.exports.deflate=(e,t)=>{let a,r;if(!e||!e.state||t>m||0>t)return e?Y(e,x):x;const n=e.state;if(!e.output||!e.input&&0!==e.avail_in||n.status===M&&t!==g)return Y(e,0===e.avail_out?v:x);n.strm=e;const s=n.last_flush;if(n.last_flush=t,n.status===F)if(2===n.wrap)e.adler=0,Q(n,31),Q(n,139),Q(n,8),n.gzhead?(Q(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),Q(n,255&n.gzhead.time),Q(n,255&n.gzhead.time>>8),Q(n,255&n.gzhead.time>>16),Q(n,255&n.gzhead.time>>24),Q(n,9===n.level?2:n.strategy>=T||2>n.level?4:0),Q(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(Q(n,255&n.gzhead.extra.length),Q(n,255&n.gzhead.extra.length>>8)),n.gzhead.hcrc&&(e.adler=f(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=C):(Q(n,0),Q(n,0),Q(n,0),Q(n,0),Q(n,0),Q(n,9===n.level?2:n.strategy>=T||2>n.level?4:0),Q(n,3),n.status=O);else{let t=I+(n.w_bits-8<<4)<<8,a=-1;a=n.strategy>=T||2>n.level?0:6>n.level?1:6===n.level?2:3,t|=a<<6,0!==n.strstart&&(t|=32),t+=31-t%31,n.status=O,J(n,t),0!==n.strstart&&(J(n,e.adler>>>16),J(n,65535&e.adler)),e.adler=1}if(n.status===C)if(n.gzhead.extra){for(a=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&!(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>a&&(e.adler=f(e.adler,n.pending_buf,n.pending-a,a)),K(e),a=n.pending,n.pending===n.pending_buf_size));)Q(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>a&&(e.adler=f(e.adler,n.pending_buf,n.pending-a,a)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=P)}else n.status=P;if(n.status===P)if(n.gzhead.name){a=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>a&&(e.adler=f(e.adler,n.pending_buf,n.pending-a,a)),K(e),a=n.pending,n.pending===n.pending_buf_size)){r=1;break}r=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,Q(n,r)}while(0!==r);n.gzhead.hcrc&&n.pending>a&&(e.adler=f(e.adler,n.pending_buf,n.pending-a,a)),0===r&&(n.gzindex=0,n.status=B)}else n.status=B;if(n.status===B)if(n.gzhead.comment){a=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>a&&(e.adler=f(e.adler,n.pending_buf,n.pending-a,a)),K(e),a=n.pending,n.pending===n.pending_buf_size)){r=1;break}r=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,Q(n,r)}while(0!==r);n.gzhead.hcrc&&n.pending>a&&(e.adler=f(e.adler,n.pending_buf,n.pending-a,a)),0===r&&(n.status=N)}else n.status=N;if(n.status===N&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&K(e),n.pending+2<=n.pending_buf_size&&(Q(n,255&e.adler),Q(n,255&e.adler>>8),e.adler=0,n.status=O)):n.status=O),0!==n.pending){if(K(e),0===e.avail_out)return n.last_flush=-1,b;}else if(0===e.avail_in&&j(t)<=j(s)&&t!==g)return Y(e,v);if(n.status===M&&0!==e.avail_in)return Y(e,v);if(0!==e.avail_in||0!==n.lookahead||t!==c&&n.status!==M){let a=n.strategy===T?ne(n,t):n.strategy===A?se(n,t):ie[n.level].func(n,t);if((a===X||a===G)&&(n.status=M),a===Z||a===X)return 0===e.avail_out&&(n.last_flush=-1),b;if(a===H&&(t===h?l(n):t!==m&&(i(n,0,0,!1),t===u&&(V(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),K(e),0===e.avail_out))return n.last_flush=-1,b}return t===g?0>=n.wrap?w:(2===n.wrap?(Q(n,255&e.adler),Q(n,255&e.adler>>8),Q(n,255&e.adler>>16),Q(n,255&e.adler>>24),Q(n,255&e.total_in),Q(n,255&e.total_in>>8),Q(n,255&e.total_in>>16),Q(n,255&e.total_in>>24)):(J(n,e.adler>>>16),J(n,65535&e.adler)),K(e),0<n.wrap&&(n.wrap=-n.wrap),0===n.pending?w:b):b},t.exports.deflateEnd=e=>{if(!e||!e.state)return x;const t=e.state.status;return t!==F&&t!==C&&t!==P&&t!==B&&t!==N&&t!==O&&t!==M?Y(e,x):(e.state=null,t===O?Y(e,E):b)},t.exports.deflateSetDictionary=(e,t)=>{let a=t.length;if(!e||!e.state)return x;const r=e.state,s=r.wrap;if(2===s||1===s&&r.status!==F||r.lookahead)return x;if(1===s&&(e.adler=_(e.adler,t,a,0)),r.wrap=0,a>=r.w_size){0===s&&(V(r.head),r.strstart=0,r.block_start=0,r.insert=0);let e=new Uint8Array(r.w_size);e.set(t.subarray(a-r.w_size,a),0),t=e,a=r.w_size}const n=e.avail_in,i=e.next_in,o=e.input;for(e.avail_in=a,e.next_in=0,e.input=t,te(r);r.lookahead>=D;){let e=r.strstart,t=r.lookahead-(D-1);do r.ins_h=W(r,r.ins_h,r.window[e+D-1]),r.prev[e&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=e,e++;while(--t);r.strstart=e,r.lookahead=D-1,te(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=D-1,r.match_available=0,e.next_in=i,e.input=o,e.avail_in=n,r.wrap=s,b},t.exports.deflateInfo="pako deflate (from Nodeca project)"},{"./adler32":7,"./constants":8,"./crc32":9,"./messages":15,"./trees":16}],11:[function(e,t){'use strict';t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],12:[function(e,t){'use strict';const a=30;t.exports=function(e,t){let r,s,n,i,o,d,l,_,f,p,c,h,u,g,m,b,w,x,E,v,y,R,T,A;const k=e.state;r=e.next_in,T=e.input,s=r+(e.avail_in-5),n=e.next_out,A=e.output,i=n-(t-e.avail_out),o=n+(e.avail_out-257),d=k.dmax,l=k.wsize,_=k.whave,f=k.wnext,p=k.window,c=k.hold,h=k.bits,u=k.lencode,g=k.distcode,m=(1<<k.lenbits)-1,b=(1<<k.distbits)-1;top:do{15>h&&(c+=T[r++]<<h,h+=8,c+=T[r++]<<h,h+=8),w=u[c&m];dolen:for(;;){if(x=w>>>24,c>>>=x,h-=x,x=255&w>>>16,0===x)A[n++]=65535&w;else if(16&x){E=65535&w,x&=15,x&&(h<x&&(c+=T[r++]<<h,h+=8),E+=c&(1<<x)-1,c>>>=x,h-=x),15>h&&(c+=T[r++]<<h,h+=8,c+=T[r++]<<h,h+=8),w=g[c&b];dodist:for(;;){if(x=w>>>24,c>>>=x,h-=x,x=255&w>>>16,16&x){if(v=65535&w,x&=15,h<x&&(c+=T[r++]<<h,h+=8,h<x&&(c+=T[r++]<<h,h+=8)),v+=c&(1<<x)-1,v>d){e.msg="invalid distance too far back",k.mode=a;break top}if(c>>>=x,h-=x,x=n-i,v>x){if(x=v-x,x>_&&k.sane){e.msg="invalid distance too far back",k.mode=a;break top}if(y=0,R=p,0===f){if(y+=l-x,x<E){E-=x;do A[n++]=p[y++];while(--x);y=n-v,R=A}}else if(f<x){if(y+=l+f-x,x-=f,x<E){E-=x;do A[n++]=p[y++];while(--x);if(y=0,f<E){x=f,E-=x;do A[n++]=p[y++];while(--x);y=n-v,R=A}}}else if(y+=f-x,x<E){E-=x;do A[n++]=p[y++];while(--x);y=n-v,R=A}for(;2<E;)A[n++]=R[y++],A[n++]=R[y++],A[n++]=R[y++],E-=3;E&&(A[n++]=R[y++],1<E&&(A[n++]=R[y++]))}else{y=n-v;do A[n++]=A[y++],A[n++]=A[y++],A[n++]=A[y++],E-=3;while(2<E);E&&(A[n++]=A[y++],1<E&&(A[n++]=A[y++]))}}else if(0==(64&x)){w=g[(65535&w)+(c&(1<<x)-1)];continue dodist}else{e.msg="invalid distance code",k.mode=a;break top}break}}else if(0==(64&x)){w=u[(65535&w)+(c&(1<<x)-1)];continue dolen}else if(32&x){k.mode=12;break top}else{e.msg="invalid literal/length code",k.mode=a;break top}break}}while(r<s&&n<o);return E=h>>3,r-=E,h-=E<<3,c&=(1<<h)-1,e.next_in=r,e.next_out=n,e.avail_in=r<s?5+(s-r):5-(r-s),e.avail_out=n<o?257+(o-n):257-(n-o),k.hold=c,void(k.bits=h)}},{}],13:[function(e,t){'use strict';var r=String.fromCharCode;function a(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const s=e("./adler32"),i=e("./crc32"),o=e("./inffast"),d=e("./inftrees"),l=1,_=2,{Z_FINISH:f,Z_BLOCK:p,Z_TREES:c,Z_OK:h,Z_STREAM_END:u,Z_NEED_DICT:g,Z_STREAM_ERROR:m,Z_DATA_ERROR:b,Z_MEM_ERROR:w,Z_BUF_ERROR:x,Z_DEFLATED:E}=e("./constants"),v=1,y=2,R=3,T=4,A=5,k=6,S=7,U=8,I=9,D=10,L=11,z=12,F=13,C=14,P=15,B=16,N=17,O=18,M=19,Z=20,H=21,X=22,G=23,Y=24,j=25,V=26,W=27,K=28,q=29,Q=30,J=31,$=e=>(255&e>>>24)+(65280&e>>>8)+((65280&e)<<8)+((255&e)<<24),ee=e=>{if(!e||!e.state)return m;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=v,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,h},te=e=>{if(!e||!e.state)return m;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,ee(e)},ae=(e,t)=>{let a;if(!e||!e.state)return m;const r=e.state;return(0>t?(a=0,t=-t):(a=(t>>4)+1,48>t&&(t&=15)),t&&(8>t||15<t))?m:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=a,r.wbits=t,te(e))},re=(e,t)=>{if(!e)return m;const r=new a;e.state=r,r.window=null;const s=ae(e,t);return s!==h&&(e.state=null),s};let se,ne,ie=!0;const oe=e=>{if(ie){se=new Int32Array(512),ne=new Int32Array(32);let t=0;for(;144>t;)e.lens[t++]=8;for(;256>t;)e.lens[t++]=9;for(;280>t;)e.lens[t++]=7;for(;288>t;)e.lens[t++]=8;for(d(l,e.lens,0,288,se,0,e.work,{bits:9}),t=0;32>t;)e.lens[t++]=5;d(_,e.lens,0,32,ne,0,e.work,{bits:5}),ie=!1}e.lencode=se,e.lenbits=9,e.distcode=ne,e.distbits=5},de=(e,t,a,r)=>{let s;const n=e.state;return null===n.window&&(n.wsize=1<<n.wbits,n.wnext=0,n.whave=0,n.window=new Uint8Array(n.wsize)),r>=n.wsize?(n.window.set(t.subarray(a-n.wsize,a),0),n.wnext=0,n.whave=n.wsize):(s=n.wsize-n.wnext,s>r&&(s=r),n.window.set(t.subarray(a-r,a-r+s),n.wnext),r-=s,r?(n.window.set(t.subarray(a-r,a),0),n.wnext=r,n.whave=n.wsize):(n.wnext+=s,n.wnext===n.wsize&&(n.wnext=0),n.whave<n.wsize&&(n.whave+=s))),0};t.exports.inflateReset=te,t.exports.inflateReset2=ae,t.exports.inflateResetKeep=ee,t.exports.inflateInit=e=>re(e,15),t.exports.inflateInit2=re,t.exports.inflate=(e,t)=>{let a,ee,te,ae,re,se,ne,ie,le,_e,fe,pe,ce,he,ue,ge,me,be,we,xe,Ee,ve,ye=0;const Re=new Uint8Array(4);let Te,Ae;const ke=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return m;a=e.state,a.mode===z&&(a.mode=F),re=e.next_out,te=e.output,ne=e.avail_out,ae=e.next_in,ee=e.input,se=e.avail_in,ie=a.hold,le=a.bits,_e=se,fe=ne,ve=h;inf_leave:for(;;)switch(a.mode){case v:if(0===a.wrap){a.mode=F;break}for(;16>le;){if(0===se)break inf_leave;se--,ie+=ee[ae++]<<le,le+=8}if(2&a.wrap&&35615===ie){a.check=0,Re[0]=255&ie,Re[1]=255&ie>>>8,a.check=i(a.check,Re,2,0),ie=0,le=0,a.mode=y;break}if(a.flags=0,a.head&&(a.head.done=!1),!(1&a.wrap)||(((255&ie)<<8)+(ie>>8))%31){e.msg="incorrect header check",a.mode=Q;break}if((15&ie)!==E){e.msg="unknown compression method",a.mode=Q;break}if(ie>>>=4,le-=4,Ee=(15&ie)+8,0===a.wbits)a.wbits=Ee;else if(Ee>a.wbits){e.msg="invalid window size",a.mode=Q;break}a.dmax=1<<a.wbits,e.adler=a.check=1,a.mode=512&ie?D:z,ie=0,le=0;break;case y:for(;16>le;){if(0===se)break inf_leave;se--,ie+=ee[ae++]<<le,le+=8}if(a.flags=ie,(255&a.flags)!==E){e.msg="unknown compression method",a.mode=Q;break}if(57344&a.flags){e.msg="unknown header flags set",a.mode=Q;break}a.head&&(a.head.text=1&ie>>8),512&a.flags&&(Re[0]=255&ie,Re[1]=255&ie>>>8,a.check=i(a.check,Re,2,0)),ie=0,le=0,a.mode=R;case R:for(;32>le;){if(0===se)break inf_leave;se--,ie+=ee[ae++]<<le,le+=8}a.head&&(a.head.time=ie),512&a.flags&&(Re[0]=255&ie,Re[1]=255&ie>>>8,Re[2]=255&ie>>>16,Re[3]=255&ie>>>24,a.check=i(a.check,Re,4,0)),ie=0,le=0,a.mode=T;case T:for(;16>le;){if(0===se)break inf_leave;se--,ie+=ee[ae++]<<le,le+=8}a.head&&(a.head.xflags=255&ie,a.head.os=ie>>8),512&a.flags&&(Re[0]=255&ie,Re[1]=255&ie>>>8,a.check=i(a.check,Re,2,0)),ie=0,le=0,a.mode=A;case A:if(1024&a.flags){for(;16>le;){if(0===se)break inf_leave;se--,ie+=ee[ae++]<<le,le+=8}a.length=ie,a.head&&(a.head.extra_len=ie),512&a.flags&&(Re[0]=255&ie,Re[1]=255&ie>>>8,a.check=i(a.check,Re,2,0)),ie=0,le=0}else a.head&&(a.head.extra=null);a.mode=k;case k:if(1024&a.flags&&(pe=a.length,pe>se&&(pe=se),pe&&(a.head&&(Ee=a.head.extra_len-a.length,!a.head.extra&&(a.head.extra=new Uint8Array(a.head.extra_len)),a.head.extra.set(ee.subarray(ae,ae+pe),Ee)),512&a.flags&&(a.check=i(a.check,ee,pe,ae)),se-=pe,ae+=pe,a.length-=pe),a.length))break inf_leave;a.length=0,a.mode=S;case S:if(2048&a.flags){if(0===se)break inf_leave;pe=0;do Ee=ee[ae+pe++],a.head&&Ee&&65536>a.length&&(a.head.name+=r(Ee));while(Ee&&pe<se);if(512&a.flags&&(a.check=i(a.check,ee,pe,ae)),se-=pe,ae+=pe,Ee)break inf_leave}else a.head&&(a.head.name=null);a.length=0,a.mode=U;case U:if(4096&a.flags){if(0===se)break inf_leave;pe=0;do Ee=ee[ae+pe++],a.head&&Ee&&65536>a.length&&(a.head.comment+=r(Ee));while(Ee&&pe<se);if(512&a.flags&&(a.check=i(a.check,ee,pe,ae)),se-=pe,ae+=pe,Ee)break inf_leave}else a.head&&(a.head.comment=null);a.mode=I;case I:if(512&a.flags){for(;16>le;){if(0===se)break inf_leave;se--,ie+=ee[ae++]<<le,le+=8}if(ie!==(65535&a.check)){e.msg="header crc mismatch",a.mode=Q;break}ie=0,le=0}a.head&&(a.head.hcrc=1&a.flags>>9,a.head.done=!0),e.adler=a.check=0,a.mode=z;break;case D:for(;32>le;){if(0===se)break inf_leave;se--,ie+=ee[ae++]<<le,le+=8}e.adler=a.check=$(ie),ie=0,le=0,a.mode=L;case L:if(0===a.havedict)return e.next_out=re,e.avail_out=ne,e.next_in=ae,e.avail_in=se,a.hold=ie,a.bits=le,g;e.adler=a.check=1,a.mode=z;case z:if(t===p||t===c)break inf_leave;case F:if(a.last){ie>>>=7&le,le-=7&le,a.mode=W;break}for(;3>le;){if(0===se)break inf_leave;se--,ie+=ee[ae++]<<le,le+=8}switch(a.last=1&ie,ie>>>=1,le-=1,3&ie){case 0:a.mode=C;break;case 1:if(oe(a),a.mode=Z,t===c){ie>>>=2,le-=2;break inf_leave}break;case 2:a.mode=N;break;case 3:e.msg="invalid block type",a.mode=Q;}ie>>>=2,le-=2;break;case C:for(ie>>>=7&le,le-=7&le;32>le;){if(0===se)break inf_leave;se--,ie+=ee[ae++]<<le,le+=8}if((65535&ie)!=(65535^ie>>>16)){e.msg="invalid stored block lengths",a.mode=Q;break}if(a.length=65535&ie,ie=0,le=0,a.mode=P,t===c)break inf_leave;case P:a.mode=B;case B:if(pe=a.length,pe){if(pe>se&&(pe=se),pe>ne&&(pe=ne),0===pe)break inf_leave;te.set(ee.subarray(ae,ae+pe),re),se-=pe,ae+=pe,ne-=pe,re+=pe,a.length-=pe;break}a.mode=z;break;case N:for(;14>le;){if(0===se)break inf_leave;se--,ie+=ee[ae++]<<le,le+=8}if(a.nlen=(31&ie)+257,ie>>>=5,le-=5,a.ndist=(31&ie)+1,ie>>>=5,le-=5,a.ncode=(15&ie)+4,ie>>>=4,le-=4,286<a.nlen||30<a.ndist){e.msg="too many length or distance symbols",a.mode=Q;break}a.have=0,a.mode=O;case O:for(;a.have<a.ncode;){for(;3>le;){if(0===se)break inf_leave;se--,ie+=ee[ae++]<<le,le+=8}a.lens[ke[a.have++]]=7&ie,ie>>>=3,le-=3}for(;19>a.have;)a.lens[ke[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,Te={bits:a.lenbits},ve=d(0,a.lens,0,19,a.lencode,0,a.work,Te),a.lenbits=Te.bits,ve){e.msg="invalid code lengths set",a.mode=Q;break}a.have=0,a.mode=M;case M:for(;a.have<a.nlen+a.ndist;){for(;;){if(ye=a.lencode[ie&(1<<a.lenbits)-1],ue=ye>>>24,ge=255&ye>>>16,me=65535&ye,ue<=le)break;if(0===se)break inf_leave;se--,ie+=ee[ae++]<<le,le+=8}if(16>me)ie>>>=ue,le-=ue,a.lens[a.have++]=me;else{if(16===me){for(Ae=ue+2;le<Ae;){if(0===se)break inf_leave;se--,ie+=ee[ae++]<<le,le+=8}if(ie>>>=ue,le-=ue,0===a.have){e.msg="invalid bit length repeat",a.mode=Q;break}Ee=a.lens[a.have-1],pe=3+(3&ie),ie>>>=2,le-=2}else if(17===me){for(Ae=ue+3;le<Ae;){if(0===se)break inf_leave;se--,ie+=ee[ae++]<<le,le+=8}ie>>>=ue,le-=ue,Ee=0,pe=3+(7&ie),ie>>>=3,le-=3}else{for(Ae=ue+7;le<Ae;){if(0===se)break inf_leave;se--,ie+=ee[ae++]<<le,le+=8}ie>>>=ue,le-=ue,Ee=0,pe=11+(127&ie),ie>>>=7,le-=7}if(a.have+pe>a.nlen+a.ndist){e.msg="invalid bit length repeat",a.mode=Q;break}for(;pe--;)a.lens[a.have++]=Ee}}if(a.mode===Q)break;if(0===a.lens[256]){e.msg="invalid code -- missing end-of-block",a.mode=Q;break}if(a.lenbits=9,Te={bits:a.lenbits},ve=d(l,a.lens,0,a.nlen,a.lencode,0,a.work,Te),a.lenbits=Te.bits,ve){e.msg="invalid literal/lengths set",a.mode=Q;break}if(a.distbits=6,a.distcode=a.distdyn,Te={bits:a.distbits},ve=d(_,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,Te),a.distbits=Te.bits,ve){e.msg="invalid distances set",a.mode=Q;break}if(a.mode=Z,t===c)break inf_leave;case Z:a.mode=H;case H:if(6<=se&&258<=ne){e.next_out=re,e.avail_out=ne,e.next_in=ae,e.avail_in=se,a.hold=ie,a.bits=le,o(e,fe),re=e.next_out,te=e.output,ne=e.avail_out,ae=e.next_in,ee=e.input,se=e.avail_in,ie=a.hold,le=a.bits,a.mode===z&&(a.back=-1);break}for(a.back=0;;){if(ye=a.lencode[ie&(1<<a.lenbits)-1],ue=ye>>>24,ge=255&ye>>>16,me=65535&ye,ue<=le)break;if(0===se)break inf_leave;se--,ie+=ee[ae++]<<le,le+=8}if(ge&&0==(240&ge)){for(be=ue,we=ge,xe=me;;){if(ye=a.lencode[xe+((ie&(1<<be+we)-1)>>be)],ue=ye>>>24,ge=255&ye>>>16,me=65535&ye,be+ue<=le)break;if(0===se)break inf_leave;se--,ie+=ee[ae++]<<le,le+=8}ie>>>=be,le-=be,a.back+=be}if(ie>>>=ue,le-=ue,a.back+=ue,a.length=me,0===ge){a.mode=V;break}if(32&ge){a.back=-1,a.mode=z;break}if(64&ge){e.msg="invalid literal/length code",a.mode=Q;break}a.extra=15&ge,a.mode=X;case X:if(a.extra){for(Ae=a.extra;le<Ae;){if(0===se)break inf_leave;se--,ie+=ee[ae++]<<le,le+=8}a.length+=ie&(1<<a.extra)-1,ie>>>=a.extra,le-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=G;case G:for(;;){if(ye=a.distcode[ie&(1<<a.distbits)-1],ue=ye>>>24,ge=255&ye>>>16,me=65535&ye,ue<=le)break;if(0===se)break inf_leave;se--,ie+=ee[ae++]<<le,le+=8}if(0==(240&ge)){for(be=ue,we=ge,xe=me;;){if(ye=a.distcode[xe+((ie&(1<<be+we)-1)>>be)],ue=ye>>>24,ge=255&ye>>>16,me=65535&ye,be+ue<=le)break;if(0===se)break inf_leave;se--,ie+=ee[ae++]<<le,le+=8}ie>>>=be,le-=be,a.back+=be}if(ie>>>=ue,le-=ue,a.back+=ue,64&ge){e.msg="invalid distance code",a.mode=Q;break}a.offset=me,a.extra=15&ge,a.mode=Y;case Y:if(a.extra){for(Ae=a.extra;le<Ae;){if(0===se)break inf_leave;se--,ie+=ee[ae++]<<le,le+=8}a.offset+=ie&(1<<a.extra)-1,ie>>>=a.extra,le-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){e.msg="invalid distance too far back",a.mode=Q;break}a.mode=j;case j:if(0===ne)break inf_leave;if(pe=fe-ne,a.offset>pe){if(pe=a.offset-pe,pe>a.whave&&a.sane){e.msg="invalid distance too far back",a.mode=Q;break}pe>a.wnext?(pe-=a.wnext,ce=a.wsize-pe):ce=a.wnext-pe,pe>a.length&&(pe=a.length),he=a.window}else he=te,ce=re-a.offset,pe=a.length;pe>ne&&(pe=ne),ne-=pe,a.length-=pe;do te[re++]=he[ce++];while(--pe);0===a.length&&(a.mode=H);break;case V:if(0===ne)break inf_leave;te[re++]=a.length,ne--,a.mode=H;break;case W:if(a.wrap){for(;32>le;){if(0===se)break inf_leave;se--,ie|=ee[ae++]<<le,le+=8}if(fe-=ne,e.total_out+=fe,a.total+=fe,fe&&(e.adler=a.check=a.flags?i(a.check,te,fe,re-fe):s(a.check,te,fe,re-fe)),fe=ne,(a.flags?ie:$(ie))!==a.check){e.msg="incorrect data check",a.mode=Q;break}ie=0,le=0}a.mode=K;case K:if(a.wrap&&a.flags){for(;32>le;){if(0===se)break inf_leave;se--,ie+=ee[ae++]<<le,le+=8}if(ie!==(4294967295&a.total)){e.msg="incorrect length check",a.mode=Q;break}ie=0,le=0}a.mode=q;case q:ve=u;break inf_leave;case Q:ve=b;break inf_leave;case J:return w;case 32:default:return m;}return(e.next_out=re,e.avail_out=ne,e.next_in=ae,e.avail_in=se,a.hold=ie,a.bits=le,(a.wsize||fe!==e.avail_out&&a.mode<Q&&(a.mode<W||t!==f))&&de(e,e.output,e.next_out,fe-e.avail_out))?(a.mode=J,w):(_e-=e.avail_in,fe-=e.avail_out,e.total_in+=_e,e.total_out+=fe,a.total+=fe,a.wrap&&fe&&(e.adler=a.check=a.flags?i(a.check,te,fe,e.next_out-fe):s(a.check,te,fe,e.next_out-fe)),e.data_type=a.bits+(a.last?64:0)+(a.mode===z?128:0)+(a.mode===Z||a.mode===P?256:0),(0===_e&&0===fe||t===f)&&ve===h&&(ve=x),ve)},t.exports.inflateEnd=e=>{if(!e||!e.state)return m;let t=e.state;return t.window&&(t.window=null),e.state=null,h},t.exports.inflateGetHeader=(e,t)=>{if(!e||!e.state)return m;const a=e.state;return 0==(2&a.wrap)?m:(a.head=t,t.done=!1,h)},t.exports.inflateSetDictionary=(e,t)=>{const a=t.length;let r,n,i;return e&&e.state?(r=e.state,0!==r.wrap&&r.mode!==L)?m:r.mode===L&&(n=1,n=s(n,t,a,0),n!==r.check)?b:(i=de(e,t,a,a),i)?(r.mode=J,w):(r.havedict=1,h):m},t.exports.inflateInfo="pako inflate (from Nodeca project)"},{"./adler32":7,"./constants":8,"./crc32":9,"./inffast":12,"./inftrees":14}],14:[function(e,t){'use strict';const a=15,r=852,s=592,n=0,i=1,o=2,d=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),l=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),_=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),f=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);t.exports=(e,t,p,c,h,u,g,m)=>{const b=m.bits;let w,x,E,v,y,R,T=0,A=0,k=0,S=0,U=0,I=0,D=0,L=0,z=0,F=0,C=null,P=0;const B=new Uint16Array(16),N=new Uint16Array(16);let O,M,Z,H=null,X=0;for(T=0;T<=a;T++)B[T]=0;for(A=0;A<c;A++)B[t[p+A]]++;for(U=b,S=a;1<=S&&0===B[S];S--);if(U>S&&(U=S),0===S)return h[u++]=20971520,h[u++]=20971520,m.bits=1,0;for(k=1;k<S&&0===B[k];k++);for(U<k&&(U=k),L=1,T=1;T<=a;T++)if(L<<=1,L-=B[T],0>L)return-1;if(0<L&&(e===n||1!==S))return-1;for(N[1]=0,T=1;T<a;T++)N[T+1]=N[T]+B[T];for(A=0;A<c;A++)0!==t[p+A]&&(g[N[t[p+A]]++]=A);if(e===n?(C=H=g,R=19):e===i?(C=d,P-=257,H=l,X-=257,R=256):(C=_,H=f,R=-1),F=0,A=0,T=k,y=u,I=U,D=0,E=-1,z=1<<U,v=z-1,e===i&&z>r||e===o&&z>s)return 1;for(;;){O=T-D,g[A]<R?(M=0,Z=g[A]):g[A]>R?(M=H[X+g[A]],Z=C[P+g[A]]):(M=96,Z=0),w=1<<T-D,x=1<<I,k=x;do x-=w,h[y+(F>>D)+x]=0|(O<<24|M<<16|Z);while(0!==x);for(w=1<<T-1;F&w;)w>>=1;if(0===w?F=0:(F&=w-1,F+=w),A++,0==--B[T]){if(T===S)break;T=t[p+g[A]]}if(T>U&&(F&v)!==E){for(0===D&&(D=U),y+=k,I=T-D,L=1<<I;I+D<S&&(L-=B[I+D],!(0>=L));)I++,L<<=1;if(z+=1<<I,e===i&&z>r||e===o&&z>s)return 1;E=F&v,h[E]=0|(U<<24|I<<16|y-u)}}return 0!==F&&(h[y+F]=0|(4194304|T-D<<24)),m.bits=U,0}},{}],15:[function(e,t){'use strict';t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],16:[function(e,t){'use strict';function a(e){for(let t=e.length;0<=--t;)e[t]=0}function r(e,t,a,r,s){this.static_tree=e,this.extra_bits=t,this.extra_base=a,this.elems=r,this.max_length=s,this.has_stree=e&&e.length}function n(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const i=0,o=1,d=1,l=29,_=256,f=_+1+l,p=30,c=19,u=2*f+1,g=15,m=16,b=256,w=16,x=17,E=18,v=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),y=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),R=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),A=Array(2*(f+2));a(A);const k=Array(2*p);a(k);const S=Array(512);a(S);const U=Array(258-3+1);a(U);const I=Array(l);a(I);const D=Array(p);a(D);let L,z,F;const C=e=>256>e?S[e]:S[256+(e>>>7)],P=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=255&t>>>8},B=(e,t,a)=>{e.bi_valid>m-a?(e.bi_buf|=65535&t<<e.bi_valid,P(e,e.bi_buf),e.bi_buf=t>>m-e.bi_valid,e.bi_valid+=a-m):(e.bi_buf|=65535&t<<e.bi_valid,e.bi_valid+=a)},N=(e,t,a)=>{B(e,a[2*t],a[2*t+1])},O=(e,t)=>{let a=0;do a|=1&e,e>>>=1,a<<=1;while(0<--t);return a>>>1},M=e=>{16===e.bi_valid?(P(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)},Z=(e,t)=>{const a=t.dyn_tree,r=t.max_code,s=t.stat_desc.static_tree,i=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,d=t.stat_desc.extra_base,l=t.stat_desc.max_length;let _,p,c,b,w,x,E=0;for(b=0;b<=g;b++)e.bl_count[b]=0;for(a[2*e.heap[e.heap_max]+1]=0,_=e.heap_max+1;_<u;_++)(p=e.heap[_],b=a[2*a[2*p+1]+1]+1,b>l&&(b=l,E++),a[2*p+1]=b,!(p>r))&&(e.bl_count[b]++,w=0,p>=d&&(w=o[p-d]),x=a[2*p],e.opt_len+=x*(b+w),i&&(e.static_len+=x*(s[2*p+1]+w)));if(0!==E){do{for(b=l-1;0===e.bl_count[b];)b--;e.bl_count[b]--,e.bl_count[b+1]+=2,e.bl_count[l]--,E-=2}while(0<E);for(b=l;0!==b;b--)for(p=e.bl_count[b];0!==p;)(c=e.heap[--_],!(c>r))&&(a[2*c+1]!==b&&(e.opt_len+=(b-a[2*c+1])*a[2*c],a[2*c+1]=b),p--)}},H=(e,t,a)=>{const r=Array(g+1);let s,i,o=0;for(s=1;s<=g;s++)r[s]=o=o+a[s-1]<<1;for(i=0;i<=t;i++){let t=e[2*i+1];0!==t&&(e[2*i]=O(r[t]++,t))}},X=()=>{let e,t,a,s,i;const o=Array(g+1);for(a=0,s=0;s<l-1;s++)for(I[s]=a,e=0;e<1<<v[s];e++)U[a++]=s;for(U[a-1]=s,i=0,s=0;16>s;s++)for(D[s]=i,e=0;e<1<<y[s];e++)S[i++]=s;for(i>>=7;s<p;s++)for(D[s]=i<<7,e=0;e<1<<y[s]-7;e++)S[256+i++]=s;for(t=0;t<=g;t++)o[t]=0;for(e=0;143>=e;)A[2*e+1]=8,e++,o[8]++;for(;255>=e;)A[2*e+1]=9,e++,o[9]++;for(;279>=e;)A[2*e+1]=7,e++,o[7]++;for(;287>=e;)A[2*e+1]=8,e++,o[8]++;for(H(A,f+1,o),e=0;e<p;e++)k[2*e+1]=5,k[2*e]=O(e,5);L=new r(A,v,_+1,f,g),z=new r(k,y,0,p,g),F=new r([],R,0,c,7)},G=e=>{let t;for(t=0;t<f;t++)e.dyn_ltree[2*t]=0;for(t=0;t<p;t++)e.dyn_dtree[2*t]=0;for(t=0;t<c;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*b]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},Y=e=>{8<e.bi_valid?P(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},j=(e,t,a,r)=>{Y(e),r&&(P(e,a),P(e,~a)),e.pending_buf.set(e.window.subarray(t,t+a),e.pending),e.pending+=a},V=(e,t,a,r)=>{const s=2*t,n=2*a;return e[s]<e[n]||e[s]===e[n]&&r[t]<=r[a]},W=(e,t,a)=>{const r=e.heap[a];for(let s=a<<1;s<=e.heap_len&&(s<e.heap_len&&V(t,e.heap[s+1],e.heap[s],e.depth)&&s++,!V(t,r,e.heap[s],e.depth));)e.heap[a]=e.heap[s],a=s,s<<=1;e.heap[a]=r},K=(e,t,a)=>{let r,s,n,i,o=0;if(0!==e.last_lit)do r=e.pending_buf[e.d_buf+2*o]<<8|e.pending_buf[e.d_buf+2*o+1],s=e.pending_buf[e.l_buf+o],o++,0===r?N(e,s,t):(n=U[s],N(e,n+_+1,t),i=v[n],0!==i&&(s-=I[n],B(e,s,i)),r--,n=C(r),N(e,n,a),i=y[n],0!==i&&(r-=D[n],B(e,r,i)));while(o<e.last_lit);N(e,b,t)},q=(e,t)=>{const a=t.dyn_tree,r=t.stat_desc.static_tree,s=t.stat_desc.has_stree,i=t.stat_desc.elems;let o,d,l,_=-1;for(e.heap_len=0,e.heap_max=u,o=0;o<i;o++)0===a[2*o]?a[2*o+1]=0:(e.heap[++e.heap_len]=_=o,e.depth[o]=0);for(;2>e.heap_len;)l=e.heap[++e.heap_len]=2>_?++_:0,a[2*l]=1,e.depth[l]=0,e.opt_len--,s&&(e.static_len-=r[2*l+1]);for(t.max_code=_,o=e.heap_len>>1;1<=o;o--)W(e,a,o);l=i;do o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],W(e,a,1),d=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=d,a[2*l]=a[2*o]+a[2*d],e.depth[l]=(e.depth[o]>=e.depth[d]?e.depth[o]:e.depth[d])+1,a[2*o+1]=a[2*d+1]=l,e.heap[1]=l++,W(e,a,1);while(2<=e.heap_len);e.heap[--e.heap_max]=e.heap[1],Z(e,t),H(a,_,e.bl_count)},Q=(e,t,a)=>{let r,s,i=-1,o=t[1],d=0,l=7,_=4;for(0===o&&(l=138,_=3),t[2*(a+1)+1]=65535,r=0;r<=a;r++){if(s=o,o=t[2*(r+1)+1],++d<l&&s===o)continue;else d<_?e.bl_tree[2*s]+=d:0===s?10>=d?e.bl_tree[2*x]++:e.bl_tree[2*E]++:(s!==i&&e.bl_tree[2*s]++,e.bl_tree[2*w]++);d=0,i=s,0===o?(l=138,_=3):s===o?(l=6,_=3):(l=7,_=4)}},J=(e,t,a)=>{let r,s,i=-1,o=t[1],d=0,l=7,_=4;for(0===o&&(l=138,_=3),r=0;r<=a;r++){if(s=o,o=t[2*(r+1)+1],++d<l&&s===o)continue;else if(d<_)do N(e,s,e.bl_tree);while(0!=--d);else 0===s?10>=d?(N(e,x,e.bl_tree),B(e,d-3,3)):(N(e,E,e.bl_tree),B(e,d-11,7)):(s!==i&&(N(e,s,e.bl_tree),d--),N(e,w,e.bl_tree),B(e,d-3,2));d=0,i=s,0===o?(l=138,_=3):s===o?(l=6,_=3):(l=7,_=4)}},$=e=>{let t;for(Q(e,e.dyn_ltree,e.l_desc.max_code),Q(e,e.dyn_dtree,e.d_desc.max_code),q(e,e.bl_desc),t=c-1;3<=t&&0===e.bl_tree[2*T[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t},ee=(e,t,a,r)=>{let s;for(B(e,t-257,5),B(e,a-1,5),B(e,r-4,4),s=0;s<r;s++)B(e,e.bl_tree[2*T[s]+1],3);J(e,e.dyn_ltree,t-1),J(e,e.dyn_dtree,a-1)},te=e=>{let t,a=4093624447;for(t=0;31>=t;t++,a>>>=1)if(1&a&&0!==e.dyn_ltree[2*t])return i;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return o;for(t=32;t<_;t++)if(0!==e.dyn_ltree[2*t])return o;return i};let ae=!1;const re=e=>{ae||(X(),ae=!0),e.l_desc=new n(e.dyn_ltree,L),e.d_desc=new n(e.dyn_dtree,z),e.bl_desc=new n(e.bl_tree,F),e.bi_buf=0,e.bi_valid=0,G(e)},se=(e,t,a,r)=>{B(e,(0<<1)+(r?1:0),3),j(e,t,a,!0)};t.exports._tr_init=re,t.exports._tr_stored_block=se,t.exports._tr_flush_block=(e,t,a,r)=>{let s,n,i=0;0<e.level?(e.strm.data_type===2&&(e.strm.data_type=te(e)),q(e,e.l_desc),q(e,e.d_desc),i=$(e),s=e.opt_len+3+7>>>3,n=e.static_len+3+7>>>3,n<=s&&(s=n)):s=n=a+5,a+4<=s&&-1!==t?se(e,t,a,r):e.strategy===4||n===s?(B(e,(d<<1)+(r?1:0),3),K(e,A,k)):(B(e,(2<<1)+(r?1:0),3),ee(e,e.l_desc.max_code+1,e.d_desc.max_code+1,i+1),K(e,e.dyn_ltree,e.dyn_dtree)),G(e),r&&Y(e)},t.exports._tr_tally=(e,t,a)=>(e.pending_buf[e.d_buf+2*e.last_lit]=255&t>>>8,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&a,e.last_lit++,0===t?e.dyn_ltree[2*a]++:(e.matches++,t--,e.dyn_ltree[2*(U[a]+_+1)]++,e.dyn_dtree[2*C(t)]++),e.last_lit===e.lit_bufsize-1),t.exports._tr_align=e=>{B(e,d<<1,3),N(e,b,A),M(e)}},{}],17:[function(e,t){'use strict';t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],18:[function(e,t){var a=String.fromCharCode;t.exports=class{constructor(e,t=!0){this.view=e,this.offset=0,this.le=t}get length(){return this.view.byteLength}get EOF(){return this.offset===this.view.byteLength}readUInt8(){return this.view.getUint8(this.offset++)}readInt8(){return this.view.getInt8(this.offset++)}readUInt16(){const e=this.view.getUint16(this.offset,this.le);return this.offset+=2,e}readInt16(){const e=this.view.getUint16(this.offset,this.le);return this.offset+=2,e}readUInt32(){const e=this.view.getUint32(this.offset,this.le);return this.offset+=4,e}readInt32(){const e=this.view.getInt32(this.offset,this.le);return this.offset+=4,e}readFloat32(){const e=this.view.getFloat32(this.offset,this.le);return this.offset+=4,e}readFloat64(){const e=this.view.getFloat64(this.offset,this.le);return this.offset+=8,e}skip(e){this.offset+=e}readUTF8String(){const e=[];for(;this.offset<this.view.byteLength;){const t=this.readUInt8();if(!t)break;e.push(a(t))}return e.join("")}readUTF16String(){const e=[];for(;this.offset<this.view.byteLength;){const t=this.readUInt16();if(!t)break;e.push(a(t))}return e.join("")}readBytes(e=0){const t=this.view.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}}},{}],19:[function(e,t){const r=new DataView(new ArrayBuffer(1048576));t.exports=class{constructor(e=!0){this.offset=0,this.le=e}writeUInt8(e){r.setUint8(this.offset++,e)}writeInt8(e){r.setInt8(this.offset++,e)}writeUInt16(e){r.setUint16(this.offset,e,this.le),this.offset+=2}writeInt16(e){r.setInt16(this.offset,e,this.le),this.offset+=2}writeUInt32(e){r.setUint32(this.offset,e,this.le),this.offset+=4}writeInt32(e){r.setInt32(this.offset,e,this.le),this.offset+=4}writeFloat32(e){r.setFloat32(this.offset,e,this.le),this.offset+=4}writeFloat64(e){r.setFloat64(this.offset,e,this.le),this.offset+=8}writeUTF8String(e){for(let t=0;t<e.length;t++)this.writeUInt8(e.charCodeAt(t));this.writeUInt8(0)}writeUTF16String(e){for(let t=0;t<e.length;t++)this.writeUInt16(e.charCodeAt(t));this.writeUInt16(0)}skip(e=0){this.offset+=e}finalize(){return r.buffer.slice(0,this.offset)}}},{}],20:[function(e,t){const a=e("pako"),r=e("../../src/network/reader"),s=e=>"object"==typeof e&&e.byteLength!==void 0;t.exports={serialize:e=>{for(const t of Object.keys(e)){const a=e[t];Array.isArray(a)&&a.every(s)||s(a)||delete e[t]}let t=0;for(const a in e){t+=a.length+1;const r=e[a];t+=4,Array.isArray(r)?r.forEach(e=>t+=e.byteLength+4):t+=r.byteLength}const r=new Uint8Array(t),n=new DataView(r.buffer);let o=0;for(const t in e){for(let e=0;e<t.length;e++)r[o++]=t.charCodeAt(e);r[o++]=0;const a=e[t],s=e=>{n.setInt32(o,e.byteLength,!0),o+=4,r.set(new Uint8Array(e),o),o+=e.byteLength};if(Array.isArray(a)){n.setInt32(o,-a.length,!0),o+=4;for(const e of a)s(e)}else s(a)}return console.assert(r.byteLength===o,"Output bytes should match final offset"),a.deflate(r,{level:9,raw:!0}).buffer},deserialize:e=>{const t={},s=new r(new DataView(a.inflate(e,{raw:!0}).buffer)),n=e=>s.readBytes(e||s.readInt32());for(;!s.EOF;){const e=s.readUTF8String(),a=s.readInt32();t[e]=0<a?n(a):Array.from({length:-a},()=>n())}return t}}},{"../../src/network/reader":18,pako:2}],21:[function(e,t){t.exports=class{constructor(e){this.port=e,this.readyState=WebSocket.CONNECTING,e.onmessage=t=>{const{data:e}=t;"message"===e.event?this.onmessage({data:e.message}):"error"===e.event?this.onerror({message:e.message}):"close"===e.event?this.onclose({code:e.code,reason:e.reason}):"open"===e.event&&(this.readyState=WebSocket.OPEN,this.onopen())},e.start(),this.onopen=this.onmessage=this.onerror=this.onclose=()=>{}}send(e){this.port.postMessage({event:"message",message:e},[e])}close(){this.port.postMessage({event:"close",code:1001,message:"Client closed connection"}),this.port.close(),this.readyState=WebSocket.CLOSED}}},{}],22:[function(e,t){t.exports=class{constructor(){this.setBuffer()}setBuffer(e){e||(self.SharedArrayBuffer?e=new SharedArrayBuffer(12):e=new ArrayBuffer(12)),this.sharedBuffer=e,this.buffer=new Int32Array(this.sharedBuffer)}get x(){return Atomics.load(this.buffer,0)}set x(e){Atomics.store(this.buffer,0,e)}get y(){return Atomics.load(this.buffer,1)}set y(e){Atomics.store(this.buffer,1,e)}get scroll(){return Atomics.load(this.buffer,2)}set scroll(e){Atomics.store(this.buffer,2,e)}updateScroll(e){Atomics.add(this.buffer,2,e)}resetScroll(){return Atomics.exchange(this.buffer,2,0)}}},{}],23:[function(e,t){var a=Math.max;const{EventEmitter:r}=e("events"),s=e("../../src/network/reader"),n=e("../../src/network/writer"),i=e("./replay-db"),{deserialize:o}=e("./custom-bson"),d=e("./fake-socket"),l=480,_=270,f=5;class p{constructor(e=0){this.score=0,this.state=new ArrayBuffer(e),this.view=new Uint8Array(this.state),this.packetTimestamps=[],this.packets=[],this.preview=new OffscreenCanvas(l,_),this.ctx=this.preview.getContext("2d"),this.ctx.imageSmoothingEnabled=!0,this.ctx.imageSmoothingQuality="high"}clearPreview(){this.ctx.clearRect(0,0,this.preview.width,this.preview.height)}}class c{constructor(e,t,a){this.t=0,this.i=0,this.protocol=t,this.renderer=e,this.source=new Uint8Array(e.core.buffer,0,e.INDICES_OFFSET),this.snapshots=Array.from({length:a*f},()=>new p(this.source.byteLength));const r=this.sharedArrayBuffer=new SharedArrayBuffer(4*(this.snapshots.length*l*_));console.log(`${(r.byteLength/1024/1024).toFixed(1)}MB preview buffer allocated for GIF generation`),this.previewPool=new Uint8ClampedArray(this.sharedArrayBuffer),this.renderer.loader.postMessage({pool:r})}async init(){this.db=await i()}encodePlayerData(){const e=new n;e.skip(1);const t=this.renderer.playerData.filter((t,a)=>{if(a&&!(250<a)&&t)return e.writeUInt8(a),e.writeUTF16String(t.name||""),e.writeUTF16String(t.skin||""),!0}),a=e.offset;return e.offset=0,e.writeUInt8(t.length),e.offset=a,e.finalize()}encodeState(e){const t=this.source.slice();this.source.set(new Uint8Array(e));const a=this.renderer.serializeState();return this.source.set(t),a}async save(){if(this.saving)return self.postMessage({event:"warning",message:"Saving Current Clip, Please Try Again Later."});this.saving=!0;const e=this.snapshots.filter(e=>e.packets.length).map(e=>e).reverse(),t=e.reduce((e,t)=>e.concat(t.packets),[]).map(e=>e.slice());let a=e.reduce((e,t)=>e.concat(t.packetTimestamps),[]);const r=Math.min(...a);a=a.map(e=>e-r);const s=this.protocol.HANDSHAKE_PACKET,n=this.encodePlayerData(),i=new Float32Array(a).buffer,o=this.encodeState(e[0].state);let d=0;for(self.postMessage({event:"replay",state:"starting"});d<e.length;)await new Promise(t=>{const a=e[d].ctx.getImageData(0,0,l,_);this.previewPool.set(a.data,a.data.byteLength*~~d),d++,requestAnimationFrame(t)});const p={handshake:s,initial:o,buffers:t,timestamps:i,players:n,PREVIEW_WIDTH:l,PREVIEW_HEIGHT:_,REPLAY_PREVIEW_FPS:f,PREVIEW_LENGTH:e.length};this.renderer.loader.postMessage({replay:p},t)}set score(e){this.snapshots[0].score=a(e,this.snapshots[0].score)}get maxScore(){return a(...this.snapshots.map(e=>e.score))}recordState(){if(!this.curr){const e=this.snapshots.pop();this.free(e),this.snapshots.unshift(e),e.view.set(this.source),this.score=this.renderer.stats.score,this.requestPreview=!0}}savePreview(){if(this.requestPreview){this.requestPreview=!1;const e=this.snapshots[0];e.clearPreview(),e.ctx.drawImage(this.renderer.canvas,0,0,e.preview.width,e.preview.height)}}recordPacket(e){this.snapshots[0].packets.push(e),this.snapshots[0].packetTimestamps.push(performance.now())}free(e){this.renderer.loader.postMessage(e.packets,e.packets),e.score=0,e.view.fill(0),e.packets=[],e.packetTimestamps=[]}resetSnapshots(){this.snapshots.forEach(e=>this.free(e))}async load(e=0){const t=await new Promise((t,a)=>{const r=this.db.transaction(["replay-data"],"readonly"),s=r.objectStore("replay-data"),n=s.get(e);r.oncomplete=()=>t(o(n.result)),r.onerror=a}),a=new Uint8Array(t.initial),r=new Float32Array(t.timestamps);this.curr={initial:a,timestamps:r,packets:t.buffers},console.assert(this.curr.timestamps.length===this.curr.packets.length,"Packet and timestamp length MUST match"),t.handshake&&this.protocol.onMessage({data:t.handshake}),this.protocol.parsePlayers(t.players),console.log("Replay loaded",this.curr)}update(e=0){if(this.curr){if(!this.t){this.source.fill(0);const e=this.renderer.core;e.HEAPU8.set(this.curr.initial,this.renderer.INDICES_OFFSET),e.instance.exports.deserialize(0,this.renderer.INDICES_OFFSET)}for(;this.curr.timestamps[this.i]<this.t;)this.protocol.onMessage({data:this.curr.packets[this.i++]});this.i>=this.curr.timestamps.length?this.resetTrack():this.t+=e}}resetTrack(){this.i=0,this.t=0,this.renderer.camera.tp=!0}}const h=[2,4];t.exports=class extends r{constructor(e){super(),this.pid=0,this.bandwidth=0,this.renderer=e,this.replay=new c(e,this,20),this.map={hw:1e4,hh:1e4},this.setupIntervals(),this.onMessage=this.onMessage.bind(this)}get connecting(){return this.ws&&this.ws.readyState==WebSocket.CONNECTING}get connected(){return this.ws&&this.ws.readyState==WebSocket.OPEN}disconnect(){this.connected&&this.ws.close(),delete this.replay.curr,this.replay.resetTrack()}connect(e,t="",a=""){this.disconnect();const r=this.ws="string"==typeof e?new WebSocket(e):new d(e);this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{this.renderer.clearCells();const e=new n;e.writeUInt8(69),e.writeInt16(420),e.writeUTF16String(t),e.writeUTF16String(a),this.ws.send(e.finalize()),this.emit("open"),delete this.ping},this.ws.onmessage=this.onMessage,this.ws.onerror=()=>self.postMessage({event:"error",message:"Connection failed"}),this.ws.onclose=t=>{this.bandwidth=0,delete this.ping,delete this.lastName,delete this.lastSkin,this.emit("close"),this.ws==r&&self.postMessage({event:"disconnect",code:t.code,reason:t.reason})}}setupIntervals(){this.replayInterval=self.setInterval(()=>this.replay.recordState(),1e3/f),this.pingInterval=self.setInterval(()=>{if(this.renderer.stats.bandwidth=this.bandwidth,this.bandwidth=0,this.connected&&this.pid&&!this.ping){const e=new ArrayBuffer(1);new Uint8Array(e)[0]=69,this.send(e),this.ping=Date.now()}},1e3);const e=this.renderer.state;this.mouseInterval=self.setInterval(()=>{if(this.connected&&this.pid&&this.renderer.state.visible){const t=new n;t.writeUInt8(3),t.writeFloat32(this.renderer.cursor.position[0]),t.writeFloat32(this.renderer.cursor.position[1]);const a=e.exchange();t.writeUInt8(a.spectate),t.writeUInt8(a.splits),t.writeUInt8(a.ejects),t.writeUInt8(a.macro),t.writeUInt8(a.lineLock),this.send(t.finalize()),a.respawn&&this.spawn(),a.clip&&!this.replaying&&this.replay.save()}},1e3/33)}send(e){this.connected&&this.ws.send(e)}onMessage(t){const e=new s(new DataView(t.data)),a=e.readUInt8();switch(this.bandwidth+=t.data.byteLength,a){case 1:this.HANDSHAKE_PACKET=t.data,this.pid=e.readUInt16(),this.map.hw=e.readUInt16(),this.map.hh=e.readUInt16(),console.log(`Map Dimension: ${this.map.hw<<1}x${this.map.hh<<1}`);const r=e.readUTF16String();this.emit("protocol"),self.postMessage({event:"connect",server:r});break;case 2:this.renderer.clearCells();break;case 3:const s=e.readUInt16(),n=e.readUTF16String(),i=e.readUTF16String();this.renderer.loadPlayerData({id:s,name:n,skin:i});break;case 4:this.parseCellData(t.data);break;case 5:this.parseLeaderboard(e);break;case 6:this.parseMinimap(e);break;case 7:if(this.parseStats(e),this.renderer.state.auto_respawn){const e=new ArrayBuffer(1);new Uint8Array(e)[0]=7,this.send(e)}break;case 10:const o=e.readUInt16(),d=e.readUTF16String(),l=this.renderer.playerData[o];if(!l)return console.warn(`Received unknown pid: ${o}, message: ${d}`);self.postMessage({event:"chat",pid:o,player:l,message:d});break;case 69:if(!this.ping)return;this.renderer.stats.ping=Date.now()-this.ping,delete this.ping;}!this.replaying&&h.includes(a)&&(this.renderer.target.position[0]||this.renderer.target.position[1])&&this.replay.recordPacket(t.data)}get player(){return this.renderer.playerData[this.pid]}parsePlayers(e){const t=new s(new DataView(e)),a=t.readUInt8();for(let r=0;r<a;r++){const e={id:t.readUInt8(),name:t.readUTF16String(),skin:t.readUTF16String()};this.renderer.loadPlayerData(e)}}parseCellData(e){this.lastPacket=this.renderer.lastTimestamp;const t=this.renderer,a=this.renderer.core,r=new DataView(e,1,23),s=this.renderer.stats.mycells,n=r.getUint16(0,!0);this.replaying&&!s&&n&&(t.camera.tp=!0),t.stats.mycells=n,t.stats.linelocked=r.getUint8(2),t.stats.score=r.getFloat32(3,!0),t.syncMouse.x=r.getFloat32(7,!0),t.syncMouse.y=r.getFloat32(11,!0),t.target.position[0]=r.getFloat32(15,!0),t.target.position[1]=r.getFloat32(19,!0),a.HEAPU8.set(new Uint8Array(e,24),t.INDICES_OFFSET),a.instance.exports.deserialize(0,t.INDICES_OFFSET)}parseLeaderboard(e){const t=e.readInt16(),a=e.readUInt8(),r={rank:t,me:this.player,players:[]};for(let t=0;t<a;t++)r.players.push(this.renderer.playerData[e.readUInt8()]);self.postMessage({event:"leaderboard",lb:r})}parseMinimap(e){const t=e.readUInt8(),a=[];for(let r=0;r<t;r++){const t=e.readUInt8(),r=this.renderer.playerData[t]||{};r.id=t,t==this.pid&&(r.me=!0);const s=e.readFloat32(),n=e.readFloat32();r.x=s/(this.map.hw<<1)+.5,r.y=n/(this.map.hh<<1)+.5,r.score=e.readFloat32(),a.push(r)}self.postMessage({event:"minimap",minimap:a})}parseStats(e){const t=e.readUInt32(),a=e.readFloat32(),r=e.readFloat32();self.postMessage({event:"stats",kills:t,score:a,surviveTime:r})}spawn(e=this.lastName,t=this.lastSkin){this.lastName=e,this.lastSkin=t;const a=new n;a.writeUInt8(1),a.writeUTF16String(e),a.writeUTF16String(t),this.send(a.finalize())}sendChat(e){const t=new n;t.writeUInt8(10),t.writeUTF16String(e),this.send(t.finalize()),this.pid&&self.postMessage({event:"chat",pid:this.pid,player:this.player,message:e})}get replaying(){return!!this.replay.curr}async startReplay(e=0){this.disconnect(),this.renderer.cleanup(),await this.replay.load(e)}}},{"../../src/network/reader":18,"../../src/network/writer":19,"./custom-bson":20,"./fake-socket":21,"./replay-db":25,events:1}],24:[function(e,t){var a=Math.PI,r=Math.max,s=Math.min;importScripts("https://cdnjs.cloudflare.com/ajax/libs/gl-matrix/2.8.1/gl-matrix-min.js");const n=e("./stats"),i=e("./mouse"),o=e("./state"),d=e("./viewport"),l=e("./protocol"),_=e("./wasm-core"),f=e("./texture-store"),{makeProgram:p,COLORS:c}=e("./util"),{SPRITE_VERT_SHADER_SOURCE:h,SPRITE_FRAG_SHADER_SOURCE:u,MASS_VERT_SHADER_SOURCE:g,MASS_FRAG_PEELING_SHADER_SOURCE:m,BORDER_VERT_SHADER_SOURCE:b,BORDER_FRAG_SHADER_SOURCE:w}=e("./shaders"),E=0,v=.25,R=-.33,T=65536,A=["0","1","2","3","4","5","6","7","8","9",".","k"],k=A.length;class S{constructor(e){this.canvas=e,this.core=new _(this),this.fbo=new Map,this.buffers=new Map,this.uniforms=new Map,this.circleTextures=[],this.playerData=Array.from({length:256}),this.playerData[0]={name:"Server"},this.updates=[],this.stats=new n,this.mouse=new i,this.state=new o,this.viewport=new d,this.viewbox={t:0,b:0,l:0,r:0},this.syncMouse={x:0,y:0},this.initLoader(),this.fps=0,this.fpsInterval=setInterval(()=>{this.stats.fps=this.fps,this.fps=0},1e3)}start(){if(this.r)return!1;const e=t=>{this.r=requestAnimationFrame(e);try{this.render(t)}catch(t){throw this.stop(),this.protocol.disconnect(),t}};return this.r=requestAnimationFrame(e),!0}stop(){return!!this.r&&(this.r=cancelAnimationFrame(this.r),!0)}loadPlayerData({id:e,skin:t,name:a,persist:r}){this.IGNORE_SKIN&&250>=e&&(t="");const s=this.playerData[e];s?(this.textures.replace(s.name,a)&&this.loader.postMessage({id:e,name:a}),this.textures.replace(s.skin,t)&&this.loader.postMessage({id:e,skin:t,quality:this.state.skin_dim})):(this.textures.add(a,r)&&this.loader.postMessage({id:e,name:a}),this.textures.add(t,r)&&this.loader.postMessage({id:e,skin:t,quality:this.state.skin_dim})),this.playerData[e]={skin:t,name:a}}initLoader(){this.loader=new Worker(self.window?"js/loader.min.js":"loader.min.js"),this.loader.onmessage=t=>{t.data&&("replay"===t.data.event?(self.postMessage(t.data),this.protocol.replay.saving=!1):t.data.id&&this.updates.unshift(t.data))}}loadUniform(e,t){this.uniforms.has(e)||this.uniforms.set(e,new Map),this.uniforms.get(e).set(t,this.gl.getUniformLocation(e,t))}getUniform(e,t){return this.uniforms.get(e).get(t)}async initEngine(){const e=this.gl=this.canvas.getContext("webgl2",{premultipliedAlpha:!1,powerPreference:"high-performance",preserveDrawingBuffer:!0});if(!e)return console.error("WebGL2 Not Supported");e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),await this.core.load(),this.wasm=this.core.instance.exports;let t=new FontFace("Bree Serif","url(/static/font/BreeSerif-Regular.ttf)");self.fonts&&fonts.add(t),await t.load(),t=new FontFace("Lato","url(/static/font/Lato-Bold.ttf)"),self.fonts&&fonts.add(t),await t.load(),this.cursor={position:vec3.create()},this.target={position:vec3.create(),scale:10},this.camera={position:vec3.create(),scale:10,tp:!1},this.proj=mat4.create(),this.IGNORE_SKIN=this.state.ignore_skin,this.SKIN_DIM=this.state.skin_dim,this.BYTES_PER_CELL_DATA=this.wasm.bytes_per_cell_data(),this.BYTES_PER_RENDER_CELL=this.wasm.bytes_per_render_cell(),this.INDICES_OFFSET=T*this.BYTES_PER_CELL_DATA,this.nameWidths=new Float32Array(256),this.nameBuffer=new Float32Array(new ArrayBuffer(6*T)),this.massWidths=new Float32Array(256),this.massCounts=new Uint8Array(T),this.massBuffer=new Float32Array(new ArrayBuffer(128*T));const a=this.core.buffer.byteLength+this.nameWidths.byteLength+this.nameBuffer.byteLength+this.massWidths.byteLength+this.massCounts.byteLength+this.massBuffer.byteLength;console.log(`${(a/1024/1024).toFixed(1)} MB allocated for renderer`),this.textures=new f(this);const r=this.main_prog=p(e,h,u),s=this.mass_prog=p(e,g,m),n=this.brdr_prog=p(e,b,w);this.loadUniform(r,"u_proj"),this.loadUniform(r,"u_uvs"),this.loadUniform(r,"u_texture"),this.loadUniform(s,"u_proj"),this.loadUniform(s,"u_uvs"),this.loadUniform(s,"u_mass_char"),this.loadUniform(n,"u_map"),this.loadUniform(n,"u_proj"),this.loadUniform(n,"u_color"),this.generateCellVAO(),this.generateNameVAO(),this.generateMassVAO(),this.generateBorderVAO(),this.generateDeadcellTexture(),this.generateCircleTexture(),this.generateMassTextures();const i=12/255;e.useProgram(n),e.uniform4f(this.getUniform(n,"u_color"),i,i,i,1),this.loadPlayerData({id:253,skin:`/static/img/virus-${this.SKIN_DIM}.png`,persist:!0}),this.start(),this.protocol=new l(this),this.protocol.on("close",this.cleanup.bind(this)),await this.protocol.replay.init()}cleanup(){this.protocol.replaying||(this.clearCells(),this.clearScreen(),this.clearPlayerData(),this.target.position.fill(0),this.textures.clear(),this.stats.reset())}teleportCamera(){this.camera.scale=this.target.scale,this.camera.position.set(this.target.position),this.camera.tp=!1}clearCells(){this.core.HEAPU32.fill(0),this.massBuffer.fill(0)}clearPlayerData(){for(let e=1;250>=e;e++)this.playerData[e]=void 0}allocBuffer(e){if(this.buffers.has(e))throw new Error(`Already allocated buffer "${e}"`);const t=this.gl.createBuffer();return this.buffers.set(e,t),t}allocFrameBuffer(e,t=1){if(this.fbo.has(e))throw new Error(`Already allocated framebuffer "${e}"`);this.fbo.set(e,1==t?this.gl.createFramebuffer():Array.from({length:t},()=>this.gl.createFramebuffer()))}freeFrameBuffer(e){if(!this.fbo.has(e))throw new Error(`Trying to free none existing framebuffer "${e}`);const t=this.fbo.get(e);if(Array.isArray(t))for(const e of t)this.gl.deleteFramebuffer(e);else this.gl.deleteFramebuffer(t);this.fbo.delete(e)}generateCellVAO(){const e=this.gl;e.bindVertexArray(this.cellVAO=e.createVertexArray()),e.bindBuffer(e.ARRAY_BUFFER,this.allocBuffer("cell_data_buffer")),e.bufferData(e.ARRAY_BUFFER,this.core.HEAPU8.subarray(0,48*T),e.DYNAMIC_DRAW);const t=e.FLOAT;e.vertexAttribPointer(0,2,t,!1,0,0),e.enableVertexAttribArray(0)}generateNameVAO(){const e=this.gl;e.bindVertexArray(this.nameVAO=e.createVertexArray()),e.bindBuffer(e.ARRAY_BUFFER,this.allocBuffer("name_data_buffer")),e.bufferData(e.ARRAY_BUFFER,this.nameBuffer,e.DYNAMIC_DRAW);const t=e.FLOAT;e.vertexAttribPointer(0,2,t,!1,0,0),e.enableVertexAttribArray(0)}generateMassVAO(){const e=this.gl;e.bindVertexArray(this.massVAO=e.createVertexArray()),e.bindBuffer(e.ARRAY_BUFFER,this.allocBuffer("mass_buffer")),e.bufferData(e.ARRAY_BUFFER,this.massBuffer,e.DYNAMIC_DRAW);const t=e.FLOAT;e.vertexAttribPointer(0,3,t,!1,0,0),e.enableVertexAttribArray(0)}generateBorderVAO(){const e=this.gl;e.bindVertexArray(this.borderVAO=e.createVertexArray()),e.bindBuffer(e.ARRAY_BUFFER,this.allocBuffer("border_buffer")),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,1,-1,-1,1,-1,-1,1,1,-1,1,1]),e.STATIC_DRAW);const t=e.FLOAT;e.vertexAttribPointer(0,2,t,!1,0,0),e.enableVertexAttribArray(0)}generateDeadcellTexture(){const e=this.gl;e.bindTexture(e.TEXTURE_2D,this.deadCellTexture=e.createTexture());const t=this.state.circle_radius,r=new OffscreenCanvas(t<<1,t<<1),s=r.getContext("2d");s.fillStyle=`rgb(255, 255, 255)`,s.globalAlpha=.1,s.arc(t,t,t,0,2*a,!1),s.fill(),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r),e.generateMipmap(e.TEXTURE_2D),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR)}generateCircleTexture(){const e=this.gl;e.activeTexture(e.TEXTURE0),this.circleTextures.length&&(this.circleTextures.forEach(a=>e.deleteTexture(a)),this.circleTextures=[]);const t=this.state.circle_radius,s=new OffscreenCanvas(t<<1,t<<1),n=s.getContext("2d");for(const[i,r,o]of c){const d=e.createTexture();e.bindTexture(e.TEXTURE_2D,d),this.circleTextures.push(d),n.fillStyle=`rgb(${i}, ${r}, ${o})`,n.clearRect(0,0,s.width,s.height),n.arc(t,t,t,0,2*a,!1),n.fill(),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,s),e.generateMipmap(e.TEXTURE_2D),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR)}const i=new Float32Array([0,1,1,1,0,0,1,1,0,0,1,0]);e.useProgram(this.main_prog),e.uniform2fv(this.getUniform(this.main_prog,"u_uvs"),i)}generateMassTextures(){const e=this.gl,t=e.createTexture();e.activeTexture(e.TEXTURE13),e.bindTexture(e.TEXTURE_2D_ARRAY,t);const a=320,r=320;{e.texImage3D(e.TEXTURE_2D_ARRAY,0,e.RGBA,a,r,k,0,e.RGBA,e.UNSIGNED_BYTE,null);const t=self.window?document.createElement("canvas"):new OffscreenCanvas(a,r);self.window&&(t.width=a,t.height=r);const s=t.getContext("2d");s.font="bold 280px Lato",s.fillStyle="white",s.strokeStyle="black",s.textAlign="center",s.lineWidth=30,s.textBaseline="middle";const n=new Float32Array(2*(4*k));for(let i=0;i<k;i++){const o=A[i];s.clearRect(0,0,t.width,t.height),s.strokeText(o,t.width>>1,t.height>>1),s.fillText(o,t.width>>1,t.height>>1);const d=(s.measureText(o).width+20)/t.width;this.massWidths[o.charCodeAt(0)]=d,e.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,i,a,r,1,e.RGBA,e.UNSIGNED_BYTE,t);const l=.5-d/2,_=.5+d/2,f=0,p=1;n[8*i+0]=l,n[8*i+1]=f,n[8*i+2]=_,n[8*i+3]=f,n[8*i+4]=l,n[8*i+5]=p,n[8*i+6]=_,n[8*i+7]=p}e.generateMipmap(e.TEXTURE_2D_ARRAY),e.texParameteri(e.TEXTURE_2D_ARRAY,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D_ARRAY,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D_ARRAY,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D_ARRAY,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.useProgram(this.mass_prog),e.uniform2fv(this.getUniform(this.mass_prog,"u_uvs"),n)}}screenToWorld(e=vec3.create(),t=0,a=0){const r=mat4.create();mat4.invert(r,this.proj),vec3.transformMat4(e,[t,-a,0],r)}updateTarget(){this.screenToWorld(this.cursor.position,this.mouse.x/4096,this.mouse.y/4096);const e=this.mouse.resetScroll();this.target.scale*=1+e/1e3,this.target.scale=s(r(this.target.scale,.01),1e4)}lerpCamera(e=1/60){const t=s(r(e*this.state.zoom,0),1);vec3.lerp(this.camera.position,this.camera.position,this.target.position,e),this.camera.scale+=(this.target.scale-this.camera.scale)*t;const a=this.camera.position[0],n=this.camera.position[1],i=this.viewport.width*this.camera.scale/2,o=this.viewport.height*this.camera.scale/2,d=this.viewbox;mat4.ortho(this.proj,d.l=a-i,d.r=a+i,d.b=n-o,d.t=n+o,0,1)}checkResolution(){const e=this.gl,t=this.state.resolution;(e.canvas.width!=t[0]||e.canvas.height!=t[1])&&(e.canvas.width=t[0],e.canvas.height=t[1])}buildMassVertexBuffer(e){var t=Math.round;let a=0;const r=e,n=this.core.HEAPF32,o=this.massCounts,d=this.massWidths,l=this.massBuffer,_=2===this.state.mass;for(let f=0;f<r.length;f++){const e=r[f]*this.BYTES_PER_CELL_DATA>>2,i=n[e+4],p=n[e+5],c=n[e+6],s=_?t(c).toString():1e3<c?(c/1e3).toFixed(1)+"k":t(c).toString();o[f]=s.length;let h=(s.length-1)*E*v;for(let e=0;e<s.length;e++)h+=v*d[s.charCodeAt(e)];let u=-h/2;for(let e=0;e<s.length;e++){const t=s.charCodeAt(e),r=46===t?10:107===t?11:t-48,n=d[t],o=u*c,_=o+v*n*c,f=(+.5*v+R)*c,h=(-.5*v+R)*c;u+=v*n+E,l[a++]=i+o,l[a++]=p+f,l[a++]=(r<<2)+0,l[a++]=i+_,l[a++]=p+f,l[a++]=(r<<2)+1,l[a++]=i+o,l[a++]=p+h,l[a++]=(r<<2)+2,l[a++]=i+_,l[a++]=p+f,l[a++]=(r<<2)+1,l[a++]=i+o,l[a++]=p+h,l[a++]=(r<<2)+2,l[a++]=i+_,l[a++]=p+h,l[a++]=(r<<2)+3}}return l.subarray(0,a)}render(e){if(!this.lastTimestamp)return void(this.lastTimestamp=e);this.fps++;const a=e-this.lastTimestamp;this.lastTimestamp=e,this.protocol.replay.update(a);const s=this.protocol.lastPacket?(e-this.protocol.lastPacket)/this.state.draw:0,{t:n,b:t,l:i,r:o}=this.viewbox,r=!this.state.visible&&!this.protocol.replay.requestPreview,d=this.wasm.update_cells(0,this.INDICES_OFFSET,s,n,t,i,o,r);if(this.stats.cells=d,this.updateTarget(),this.camera.tp?this.teleportCamera():this.lerpCamera(a/this.state.draw),this.checkResolution(),r)return this.updateTextures();const l=this.gl;l.viewport(0,0,l.drawingBufferWidth,l.drawingBufferHeight),this.clearScreen(),this.protocol.map&&(l.useProgram(this.brdr_prog),l.bindVertexArray(this.borderVAO),l.uniform2f(this.getUniform(this.brdr_prog,"u_map"),this.protocol.map.hw,this.protocol.map.hh),l.uniformMatrix4fv(this.getUniform(this.brdr_prog,"u_proj"),!1,this.proj),l.drawArrays(l.TRIANGLES,0,6)),this.draw(d),this.protocol.replay.savePreview(),this.updateTextures(),this.lastDraw=e}draw(e){const a=new Uint16Array(this.core.buffer,this.INDICES_OFFSET,e),r=this.INDICES_OFFSET+(e<<1),s=this.core.HEAPU8.subarray(r,r+e);let n=r+e;for(;3&n;)n++;const i=this.wasm.draw_cells(0,this.INDICES_OFFSET,e,n),o=n+48*e;console.assert(i===o,`Expecting end pointer to be ${o}, but got ${i}`);if(this.state.mass||this.state.name){const{l:a,r:s,t:r,b:t}=this.viewbox,n=s-a,i=r-t,o=(n<i?n:i)*.03;this.wasm.find_text_index(0,this.INDICES_OFFSET,e,o)}const d=this.gl,l=this.circleTextures,_=this.deadCellTexture,f=l.length,t=new Float32Array(this.core.buffer,n,12*e),p=this.state.skin,c=this.playerData.map(e=>{if(!e)return null;const t=this.textures.get(e.skin);return t?t.tex:null}),h=this.state.name,u=this.state.mass;d.useProgram(this.main_prog),d.uniformMatrix4fv(this.getUniform(this.main_prog,"u_proj"),!1,this.proj),d.bindVertexArray(this.cellVAO),d.bindBuffer(d.ARRAY_BUFFER,this.buffers.get("cell_data_buffer")),d.bufferSubData(d.ARRAY_BUFFER,0,t),d.activeTexture(d.TEXTURE0);for(let r=0;r<e;r++){const e=s[r];253!==e&&(d.bindTexture(d.TEXTURE_2D,254===e?l[a[r]%f]:251===e?_:l[e%f]),d.drawArrays(d.TRIANGLES,6*r,6)),(p&&c[e]||253===e)&&(d.bindTexture(d.TEXTURE_2D,c[e]),d.drawArrays(d.TRIANGLES,6*r,6))}}serializeState(){return this.core.buffer.slice(this.INDICES_OFFSET,this.wasm.serialize_state(0,this.INDICES_OFFSET))}updateTextures(){const e=this.gl;if(this.updates.length){e.activeTexture(e.TEXTURE11);for(let e=2;this.updates.length&&e--;){const{id:t,skin:a,name:r}=this.updates.pop(),s=this.playerData[t];if(s&&(this.textures.setData(s.skin,a),this.textures.setData(s.name,r)),2<++e)break}}}clearScreen(){const e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,null),e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT)}}self.window?self.Renderer=S:self.addEventListener("message",async function(t){const{data:e}=t,a=self.r=new S(e.offscreen);a.stats.setBuffer(e.stats),a.mouse.setBuffer(e.mouse),a.state.setBuffer(e.state),a.viewport.setBuffer(e.viewport),await a.initEngine(),self.addEventListener("message",t=>{const e=a.protocol;t.data.connect&&!e.connecting&&e.connect(t.data.connect,t.data.name,t.data.skin),t.data.spawn&&(e.connecting?e.once("protocol",()=>e.spawn(t.data.name,t.data.skin)):e.spawn(t.data.name,t.data.skin)),t.data.chat&&e.sendChat(t.data.chat),t.data.replay&&e.startReplay(t.data.replay)}),self.postMessage({event:"ready"})},{once:!0}),t.exports=S},{"./mouse":22,"./protocol":23,"./shaders":26,"./state":27,"./stats":28,"./texture-store":29,"./util":30,"./viewport":31,"./wasm-core":32}],25:[function(e,t){t.exports=()=>new Promise((e,t)=>{const a=indexedDB.open("ogar69-replay");a.onupgradeneeded=t=>{console.log("Creating replay object store");const e=t.target.result;e.createObjectStore("replay-meta"),e.createObjectStore("replay-data")},a.onsuccess=()=>e(a.result),a.onerror=t})},{}],26:[function(e,t){t.exports.SPRITE_VERT_SHADER_SOURCE=`#version 300 es
precision highp float;

uniform mat4 u_proj;
uniform vec2 u_uvs[6];

layout(location=0) in vec2 pos;

out vec2 uv;

void main() {
    gl_Position = u_proj * vec4(pos, 0.0f, 1.0f);
    uv = u_uvs[gl_VertexID % 6];
}
`,t.exports.SPRITE_FRAG_SHADER_SOURCE=`#version 300 es
precision highp float;

uniform sampler2D u_texture;

in vec2 uv;
out vec4 color;

void main() {
    color = texture(u_texture, uv);
}
`,t.exports.MASS_VERT_SHADER_SOURCE=`#version 300 es
precision highp float;
precision highp int;

uniform mat4 u_proj;
uniform vec2 u_uvs[48];

layout(location=0) in vec3 a_position;

out vec2 v_texcoord;
flat out int character;

void main() {
    vec4 world_pos = vec4(a_position.xy, 0.0, 1.0);
    gl_Position = u_proj * world_pos;
    character = int(a_position.z) >> 2;
    v_texcoord = u_uvs[int(a_position.z)];
}
`,t.exports.MASS_FRAG_PEELING_SHADER_SOURCE=`#version 300 es

precision highp float;
precision highp int;
precision highp sampler2DArray;

uniform sampler2DArray u_mass_char;

in vec2 v_texcoord;
flat in int character;

out vec4 color;

void main() {
    color = texture(u_mass_char, vec3(v_texcoord, character));
}
`,t.exports.BORDER_VERT_SHADER_SOURCE=`#version 300 es
precision highp float;

layout(location=0) in vec2 a_position;
uniform mat4 u_proj;
uniform vec2 u_map;
void main() {
    gl_Position = u_proj * vec4(a_position * u_map, 0.0, 1.0);
}
`,t.exports.BORDER_FRAG_SHADER_SOURCE=`#version 300 es
precision highp float;

uniform vec4 u_color;
out vec4 color;
void main() {
    color = u_color;
}
`},{}],27:[function(e,t){t.exports=class{constructor(){this.setBuffer()}setBuffer(e){e||(self.SharedArrayBuffer?e=new SharedArrayBuffer(200):e=new ArrayBuffer(200)),this.sharedBuffer=e,this.buffer=new Int32Array(this.sharedBuffer)}get resolution(){return[[1920,1080],[1280,720],[854,480]][this.quality]||[1920,1080]}get spectate(){return Atomics.load(this.buffer,0)}set spectate(e){Atomics.store(this.buffer,0,e)}get splits(){return Atomics.load(this.buffer,1)}set splits(e){Atomics.add(this.buffer,1,e)}get ejects(){return Atomics.load(this.buffer,2)}set ejects(e){Atomics.add(this.buffer,2,e)}get macro(){return Atomics.load(this.buffer,3)}set macro(e){Atomics.store(this.buffer,3,e)}get respawn(){return Atomics.load(this.buffer,4)}set respawn(e){Atomics.store(this.buffer,4,e)}get visible(){return Atomics.load(this.buffer,5)}set visible(e){Atomics.store(this.buffer,5,e)}get lineLock(){return Atomics.load(this.buffer,6)}set lineLock(e){Atomics.store(this.buffer,6,e)}get skin(){return Atomics.load(this.buffer,7)}set skin(e){Atomics.store(this.buffer,7,e)}get name(){return Atomics.load(this.buffer,8)}set name(e){Atomics.store(this.buffer,8,e)}get mass(){return Atomics.load(this.buffer,9)}set mass(e){Atomics.store(this.buffer,9,e)}get draw(){return Atomics.load(this.buffer,10)}set draw(e){Atomics.store(this.buffer,10,e)}get zoom(){return Atomics.load(this.buffer,11)}set zoom(e){Atomics.store(this.buffer,11,e)}get auto_respawn(){return Atomics.load(this.buffer,12)}set auto_respawn(e){Atomics.store(this.buffer,12,e)}get clip(){return Atomics.load(this.buffer,13)}set clip(e){Atomics.store(this.buffer,13,e)}get skin_quality(){return Atomics.load(this.buffer,14)}set skin_quality(e){Atomics.store(this.buffer,14,e)}get text_quality(){return Atomics.load(this.buffer,15)}set text_quality(e){Atomics.store(this.buffer,15,e)}get circle_quality(){return Atomics.load(this.buffer,16)}set circle_quality(e){Atomics.store(this.buffer,16,e)}get circle_radius(){return[1024,512,256,128][this.circle_quality]}get skin_dim(){return[1024,512,256,128][this.skin_quality]}get ignore_skin(){return Atomics.load(this.buffer,17)}set ignore_skin(e){Atomics.store(this.buffer,17,e)}get mouse_sync(){return Atomics.load(this.buffer,18)}set mouse_sync(e){Atomics.store(this.buffer,18,e)}get quality(){return Atomics.load(this.buffer,19)}set quality(e){Atomics.store(this.buffer,19,e)}exchange(){return{spectate:Atomics.exchange(this.buffer,0,0),splits:Atomics.exchange(this.buffer,1,0),ejects:Atomics.exchange(this.buffer,2,0),macro:this.macro,respawn:Atomics.exchange(this.buffer,4,0),lineLock:Atomics.exchange(this.buffer,6,0),clip:Atomics.exchange(this.buffer,13,0)}}}},{}],28:[function(e,t){t.exports=class{constructor(){this.setBuffer()}setBuffer(e){e||(self.SharedArrayBuffer?e=new SharedArrayBuffer(32):e=new ArrayBuffer(32)),this.sharedBuffer=e,this.buffer=new Int32Array(this.sharedBuffer)}get fps(){return Atomics.load(this.buffer,0)}set fps(e){Atomics.store(this.buffer,0,e)}get ping(){return Atomics.load(this.buffer,1)}set ping(e){Atomics.store(this.buffer,1,e)}get cells(){return Atomics.load(this.buffer,2)}set cells(e){Atomics.store(this.buffer,2,e)}get text(){return Atomics.load(this.buffer,3)}set text(e){Atomics.store(this.buffer,3,e)}get bandwidth(){return Atomics.load(this.buffer,4)}set bandwidth(e){Atomics.store(this.buffer,4,e)}get mycells(){return Atomics.load(this.buffer,5)}set mycells(e){Atomics.store(this.buffer,5,e)}get linelocked(){return Atomics.load(this.buffer,6)}set linelocked(e){Atomics.store(this.buffer,6,e)}get score(){return Atomics.load(this.buffer,7)}set score(e){Atomics.store(this.buffer,7,e)}reset(){this.buffer.fill(0)}}},{}],29:[function(e,t){class a{constructor(e,t="",a=!1){this.store=e,this.persist=a,this.key=t,this.tex=null,this.dim=[0,0],this.ref=1}incre(){this.persist||this.ref++}decre(){if(!this.persist)return this.ref--,!!(0>=this.ref)&&this.destroy()}destroy(){return!this.persist&&!!this.tex&&(this.store.gl.deleteTexture(this.tex),this.tex=null,!0)}}t.exports=class{constructor(e){this.renderer=e,this.textures=new Map}get gl(){return this.renderer.gl}add(e="",t=!1){return e?this.textures.has(e)?(this.textures.get(e).incre(),!1):(this.textures.set(e,new a(this,e,t)),!0):void 0}get(e=""){return this.textures.get(e)}setData(e="",t){if(t){const a=this.get(e);if(a){const e=this.gl;e.bindTexture(e.TEXTURE_2D,a.tex=e.createTexture()),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.generateMipmap(e.TEXTURE_2D),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),a.dim=[t.width,t.height]}else console.warn(`Trying to call store.setData on none-existing key: "${e}"`);t.close()}}replace(e="",t=""){if(e!=t)return this.textures.has(e)&&this.textures.get(e).decre()&&this.textures.delete(e),this.add(t)}clear(){for(const[e,t]of[...this.textures.entries()])t.persist||(t.destroy(),this.textures.delete(e))}}},{}],30:[function(e,t){t.exports.pick=e=>e[~~(Math.random()*e.length)],t.exports.makeProgram=(e,t,a)=>{const r=e.createShader(e.VERTEX_SHADER),s=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(r,t),e.shaderSource(s,a),e.compileShader(r),e.compileShader(s);const n=e.createProgram();if(e.attachShader(n,r),e.attachShader(n,s),e.linkProgram(n),!e.getProgramParameter(n,e.LINK_STATUS))throw console.error(`vs info-log: ${e.getShaderInfoLog(r)}\n`+`info-log: ${e.getShaderInfoLog(s)}`),new Error(`prog link failed: ${e.getProgramInfoLog(n)}`);return n},t.exports.COLORS=[[255,0,0],[255,128,0],[255,255,0],[128,255,0],[0,255,0],[0,255,128],[0,255,255],[0,128,255],[127,0,255],[255,0,255],[255,0,127]]},{}],31:[function(e,t){t.exports=class{constructor(){this.setBuffer()}setBuffer(e){e||(self.SharedArrayBuffer?e=new SharedArrayBuffer(8):e=new ArrayBuffer(8)),this.sharedBuffer=e,this.buffer=new Int32Array(this.sharedBuffer)}get width(){return Atomics.load(this.buffer,0)}set width(e){Atomics.store(this.buffer,0,e)}get height(){return Atomics.load(this.buffer,1)}set height(e){Atomics.store(this.buffer,1,e)}}},{}],32:[function(e,t){t.exports=class{constructor(e){this.renderer=e}async load(e=1024){if(this.loading||this.instance)return!1;this.loading=!0;const t=await fetch("/static/wasm/client.wasm"),a=new WebAssembly.Memory({initial:e,maximum:e}),r=[];return this.instance=await WebAssembly.instantiate(await WebAssembly.compile(await t.arrayBuffer()),{env:{memory:a,set_camera:(e,t)=>{this.renderer.camera.position[0]=this.renderer.target.position[0]=e,this.renderer.camera.position[1]=this.renderer.target.position[1]=t},print_list:()=>{if(r.length){const e=new Set;let t=0;for(const a of r){if(e.has(a))break;e.add(a),t++}const a=r.slice(0,t+2);console.log(`List{${a.length}}: [${a.map(e=>~~e).join(", ")}]`),r.splice(0,r.length)}},list:e=>r.push(~~e),log_remove:(e,t,a)=>{console.log(`Remove prev#${e}, curr#${t}, next#${a}`)},log_add:e=>console.log(`Add ${e}`),log_node:(e,t)=>console.log(`Node#${e}, type${t}`)}}),this.buffer=a.buffer,this.HEAPU8=new Uint8Array(a.buffer),this.HEAPU16=new Uint16Array(a.buffer),this.HEAPF32=new Float32Array(a.buffer),this.HEAPU32=new Uint32Array(a.buffer),this.loading=!1,!0}}},{}]},{},[24]);